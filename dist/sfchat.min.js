!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=43)}([function(e,t,n){"use strict";function r(e,t){for(var n=[],r=[],o=arguments.length;o-- >2;)n.push(arguments[o]);for(;n.length;){var i=n.pop();if(i&&i.pop)for(o=i.length;o--;)n.push(i[o]);else null!=i&&!0!==i&&!1!==i&&r.push(i)}return"function"==typeof e?e(t||{},r):{nodeName:e,attributes:t||{},children:r,key:t&&t.key}}function o(e,t,n,r){var o,i=[].map,s=r&&r.children[0]||null,a=s&&function e(t){return{nodeName:t.nodeName.toLowerCase(),attributes:{},children:i.call(t.childNodes,function(t){return 3===t.nodeType?t.nodeValue:e(t)})}}(s),u=[],c=!0,f=g(e),l=function e(t,n,r){for(var o in r)"function"==typeof r[o]?function(e,o){r[e]=function(e){var i=o(e);return"function"==typeof i&&(i=i(b(t,f),r)),i&&i!==(n=b(t,f))&&!i.then&&p(f=m(t,g(n,i),f)),i}}(o,r[o]):e(t.concat(o),n[o]=g(n[o]),r[o]=g(r[o]));return r}([],f,g(t));return p(),l;function h(e){return"function"==typeof e?h(e(f,l)):null!=e?e:""}function d(){o=!o;var e=h(n);for(r&&!o&&(s=function e(t,n,r,o,i){if(o===r);else if(null==r||r.nodeName!==o.nodeName){var s=function e(t,n){var r="string"==typeof t||"number"==typeof t?document.createTextNode(t):(n=n||"svg"===t.nodeName)?document.createElementNS("http://www.w3.org/2000/svg",t.nodeName):document.createElement(t.nodeName);var o=t.attributes;if(o){o.oncreate&&u.push(function(){o.oncreate(r)});for(var i=0;i<t.children.length;i++)r.appendChild(e(t.children[i]=h(t.children[i]),n));for(var s in o)A(r,s,o[s],null,n)}return r}(o,i);t.insertBefore(s,n),null!=r&&w(t,n,r),n=s}else if(null==r.nodeName)n.nodeValue=o;else{!function(e,t,n,r){for(var o in g(t,n))n[o]!==("value"===o||"checked"===o?e[o]:t[o])&&A(e,o,n[o],t[o],r);var i=c?n.oncreate:n.onupdate;i&&u.push(function(){i(e,t)})}(n,r.attributes,o.attributes,i=i||"svg"===o.nodeName);for(var a={},f={},l=[],d=r.children,p=o.children,m=0;m<d.length;m++){l[m]=n.childNodes[m];var b=v(d[m]);null!=b&&(a[b]=[l[m],d[m]])}for(var m=0,y=0;y<p.length;){var b=v(d[m]),S=v(p[y]=h(p[y]));if(f[b])m++;else if(null==S||S!==v(d[m+1]))if(null==S||c)null==b&&(e(n,l[m],d[m],p[y],i),y++),m++;else{var I=a[S]||[];b===S?(e(n,I[0],I[1],p[y],i),m++):I[0]?e(n,n.insertBefore(I[0],l[m]),I[1],p[y],i):e(n,l[m],null,p[y],i),f[S]=p[y],y++}else null==b&&w(n,l[m],d[m]),m++}for(;m<d.length;)null==v(d[m])&&w(n,l[m],d[m]),m++;for(var m in a)f[m]||w(n,a[m][0],a[m][1])}return n}(r,s,a,a=e)),c=!1;u.length;)u.pop()()}function p(){o||(o=!0,setTimeout(d))}function g(e,t){var n={};for(var r in e)n[r]=e[r];for(var r in t)n[r]=t[r];return n}function m(e,t,n){var r={};return e.length?(r[e[0]]=e.length>1?m(e.slice(1),t,n[e[0]]):t,g(n,r)):t}function b(e,t){for(var n=0;n<e.length;)t=t[e[n++]];return t}function v(e){return e?e.key:null}function y(e){return e.currentTarget.events[e.type](e)}function A(e,t,n,r,o){if("key"===t);else if("style"===t)for(var i in g(r,n)){var s=null==n||null==n[i]?"":n[i];"-"===i[0]?e[t].setProperty(i,s):e[t][i]=s}else"o"===t[0]&&"n"===t[1]?(t=t.slice(2),e.events?r||(r=e.events[t]):e.events={},e.events[t]=n,n?r||e.addEventListener(t,y):e.removeEventListener(t,y)):t in e&&"list"!==t&&!o?e[t]=null==n?"":n:null!=n&&!1!==n&&e.setAttribute(t,n),null!=n&&!1!==n||e.removeAttribute(t)}function w(e,t,n){function r(){e.removeChild(function e(t,n){var r=n.attributes;if(r){for(var o=0;o<n.children.length;o++)e(t.childNodes[o],n.children[o]);r.ondestroy&&r.ondestroy(t)}return t}(t,n))}var o=n.attributes&&n.attributes.onremove;o?o(t,r):r()}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o})},function(e,t,n){"use strict";var r=n(12),o=n(39),i=Object.prototype.toString;function s(e){return"[object Array]"===i.call(e)}function a(e){return null!==e&&"object"==typeof e}function u(e){return"[object Function]"===i.call(e)}function c(e,t){if(null!==e&&void 0!==e)if("object"!=typeof e&&(e=[e]),s(e))for(var n=0,r=e.length;n<r;n++)t.call(null,e[n],n,e);else for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.call(null,e[o],o,e)}e.exports={isArray:s,isArrayBuffer:function(e){return"[object ArrayBuffer]"===i.call(e)},isBuffer:o,isFormData:function(e){return"undefined"!=typeof FormData&&e instanceof FormData},isArrayBufferView:function(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&e.buffer instanceof ArrayBuffer},isString:function(e){return"string"==typeof e},isNumber:function(e){return"number"==typeof e},isObject:a,isUndefined:function(e){return void 0===e},isDate:function(e){return"[object Date]"===i.call(e)},isFile:function(e){return"[object File]"===i.call(e)},isBlob:function(e){return"[object Blob]"===i.call(e)},isFunction:u,isStream:function(e){return a(e)&&u(e.pipe)},isURLSearchParams:function(e){return"undefined"!=typeof URLSearchParams&&e instanceof URLSearchParams},isStandardBrowserEnv:function(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product)&&"undefined"!=typeof window&&"undefined"!=typeof document},forEach:c,merge:function e(){var t={};function n(n,r){"object"==typeof t[r]&&"object"==typeof n?t[r]=e(t[r],n):t[r]=n}for(var r=0,o=arguments.length;r<o;r++)c(arguments[r],n);return t},extend:function(e,t,n){return c(t,function(t,o){e[o]=n&&"function"==typeof t?r(t,n):t}),e},trim:function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")}}},function(e,t,n){e.exports=n(40)},function(e,t,n){"use strict";(function(t){var r=n(1),o=n(37),i={"Content-Type":"application/x-www-form-urlencoded"};function s(e,t){!r.isUndefined(e)&&r.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var a={adapter:function(){var e;return"undefined"!=typeof XMLHttpRequest?e=n(11):void 0!==t&&(e=n(11)),e}(),transformRequest:[function(e,t){return o(t,"Content-Type"),r.isFormData(e)||r.isArrayBuffer(e)||r.isBuffer(e)||r.isStream(e)||r.isFile(e)||r.isBlob(e)?e:r.isArrayBufferView(e)?e.buffer:r.isURLSearchParams(e)?(s(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):r.isObject(e)?(s(t,"application/json;charset=utf-8"),JSON.stringify(e)):e}],transformResponse:[function(e){if("string"==typeof e)try{e=JSON.parse(e)}catch(e){}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};r.forEach(["delete","get","head"],function(e){a.headers[e]={}}),r.forEach(["post","put","patch"],function(e){a.headers[e]=r.merge(i)}),e.exports=a}).call(this,n(13))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDE1LjY0MiAxNS42NDIiIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiBlbmFibGUtYmFja2dyb3VuZD0ibmV3IDAgMCAxNS42NDIgMTUuNjQyIj4KICA8cGF0aCBmaWxsPSIjZmZmIiBkPSJNOC44ODIsNy44MjFsNi41NDEtNi41NDFjMC4yOTMtMC4yOTMsMC4yOTMtMC43NjgsMC0xLjA2MSAgYy0wLjI5My0wLjI5My0wLjc2OC0wLjI5My0xLjA2MSwwTDcuODIxLDYuNzZMMS4yOCwwLjIyYy0wLjI5My0wLjI5My0wLjc2OC0wLjI5My0xLjA2MSwwYy0wLjI5MywwLjI5My0wLjI5MywwLjc2OCwwLDEuMDYxICBsNi41NDEsNi41NDFMMC4yMiwxNC4zNjJjLTAuMjkzLDAuMjkzLTAuMjkzLDAuNzY4LDAsMS4wNjFjMC4xNDcsMC4xNDYsMC4zMzgsMC4yMiwwLjUzLDAuMjJzMC4zODQtMC4wNzMsMC41My0wLjIybDYuNTQxLTYuNTQxICBsNi41NDEsNi41NDFjMC4xNDcsMC4xNDYsMC4zMzgsMC4yMiwwLjUzLDAuMjJjMC4xOTIsMCwwLjM4NC0wLjA3MywwLjUzLTAuMjJjMC4yOTMtMC4yOTMsMC4yOTMtMC43NjgsMC0xLjA2MUw4Ljg4Miw3LjgyMXoiLz4KPC9zdmc+"},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzgiIGhlaWdodD0iMzgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgc3Ryb2tlPSIjMjFkMjc2Ij48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxIDEpIiBzdHJva2Utd2lkdGg9IjIiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PGNpcmNsZSBzdHJva2Utb3BhY2l0eT0iLjUiIGN4PSIxOCIgY3k9IjE4IiByPSIxOCIvPjxwYXRoIGQ9Ik0zNiAxOGMwLTkuOTQtOC4wNi0xOC0xOC0xOCI+PGFuaW1hdGVUcmFuc2Zvcm0gYXR0cmlidXRlTmFtZT0idHJhbnNmb3JtIiB0eXBlPSJyb3RhdGUiIGZyb209IjAgMTggMTgiIHRvPSIzNjAgMTggMTgiIGR1cj0iMXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIi8+PC9wYXRoPjwvZz48L3N2Zz4="},function(e,t,n){(function(t){e.exports=function(){"use strict";"undefined"!=typeof window?window:void 0!==t||"undefined"!=typeof self&&self;var e,n,r=(function(e,t){var n;n=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:r})},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t,n){function r(e){var t={};if(!e)return t;for(var n=0,r=e.split("\r\n");n<r.length;n++){var o=r[n],i=o.indexOf(": ");if(i>0){var s=o.substring(0,i),a=o.substring(i+2);t[s]=a}}return t}Object.defineProperty(t,"__esModule",{value:!0}),t.responseToHeadersObject=r;var o=function(){function e(e,t,n){this.statusCode=e,this.headers=t,this.info=n}return e.fromXHR=function(t){var n=t.responseText;try{n=JSON.parse(t.responseText)}catch(e){}return new e(t.status,r(t.getAllResponseHeaders()),n)},e}();t.ErrorResponse=o;var i=function(e){this.error=e};t.NetworkError=i,function(e){e[e.UNSENT=0]="UNSENT",e[e.OPENED=1]="OPENED",e[e.HEADERS_RECEIVED=2]="HEADERS_RECEIVED",e[e.LOADING=3]="LOADING",e[e.DONE=4]="DONE"}(t.XhrReadyState||(t.XhrReadyState={}))},function(e,t,n){var r;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.VERBOSE=1]="VERBOSE",e[e.DEBUG=2]="DEBUG",e[e.INFO=3]="INFO",e[e.WARNING=4]="WARNING",e[e.ERROR=5]="ERROR"}(r=t.LogLevel||(t.LogLevel={}));var o=function(){function e(e){void 0===e&&(e=2),this.threshold=e;var t=Array(),n="--------------------------------------------------------------------------------";window.console.group||(window.console.group=function(e){t.push(e),window.console.log("%c \nBEGIN GROUP: %c",n,e)}),window.console.groupEnd||(window.console.groupEnd=function(){window.console.log("END GROUP: %c\n%c",t.pop(),n)})}return e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(window.console.log,r.VERBOSE,e)},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(window.console.log,r.DEBUG,e)},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(window.console.info,r.INFO,e)},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(window.console.warn,r.WARNING,e)},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.log(window.console.error,r.ERROR,e)},e.prototype.log=function(e,t,n){var o=this;if(t>=this.threshold){var i="Logger."+r[t];n.length>1?(window.console.group(),n.forEach(function(t){o.errorAwareLog(e,t,i)}),window.console.groupEnd()):this.errorAwareLog(e,n[0],i)}},e.prototype.errorAwareLog=function(e,t,n){if(void 0!==t&&t.info&&t.info.error_uri){var r=t.info.error_description;e((r||"An error has occurred")+". More information can be found at "+t.info.error_uri+". Error object: ",t)}else e(n+": ",t)},e}();t.ConsoleLogger=o;var i=function(){function e(){}return e.prototype.verbose=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.prototype.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.prototype.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.prototype.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e.prototype.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]},e}();t.EmptyLogger=i},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.createRetryStrategyOptionsOrDefault=function(e){var t=e.initialTimeoutMillis||1e3,n=e.maxTimeoutMillis||5e3,r=-1;return void 0!==e.limit&&null!=e.limit&&(r=e.limit),{increaseTimeout:void 0!==e.increaseTimeout?e.increaseTimeout:function(e){return 2*e>n?n:2*e},initialTimeoutMillis:t,limit:r,maxTimeoutMillis:n}};var o=function(e){this.waitTimeMillis=e};t.Retry=o;var i=function(e){this.error=e};t.DoNotRetry=i;var s=function(){function e(e,t,n){this.options=e,this.logger=t,this.retryUnsafeRequests=n,this.currentRetryCount=0,this.initialTimeoutMillis=e.initialTimeoutMillis,this.maxTimeoutMillis=e.maxTimeoutMillis,this.limit=e.limit,this.increaseTimeoutFunction=e.increaseTimeout,this.currentBackoffMillis=this.initialTimeoutMillis}return e.prototype.attemptRetry=function(e){return this.logger.verbose(this.constructor.name+": Error received",e),this.currentRetryCount>=this.limit&&this.limit>=0?(this.logger.verbose(this.constructor.name+": Retry count is over the maximum limit: "+this.limit),new i(e)):e instanceof r.ErrorResponse&&e.headers["Retry-After"]?(this.logger.verbose(this.constructor.name+": Retry-After header is present, retrying in "+e.headers["Retry-After"]),new o(1e3*parseInt(e.headers["Retry-After"],10))):e instanceof r.NetworkError||e instanceof r.ErrorResponse&&("GET"===(t=(t=e.headers["Request-Method"]).toUpperCase())||"HEAD"===t||"OPTIONS"===t||"SUBSCRIBE"===t)||this.retryUnsafeRequests?this.shouldSafeRetry(e):e instanceof r.NetworkError?this.shouldSafeRetry(e):(this.logger.verbose(this.constructor.name+": Error is not retryable",e),new i(e));var t},e.prototype.shouldSafeRetry=function(e){return e instanceof r.NetworkError?(this.logger.verbose(this.constructor.name+": It's a Network Error, will retry",e),new o(this.calulateMillisToRetry())):e instanceof r.ErrorResponse&&e.statusCode>=500&&e.statusCode<600?(this.logger.verbose(this.constructor.name+": Error 5xx, will retry"),new o(this.calulateMillisToRetry())):(this.logger.verbose(this.constructor.name+": Error is not retryable",e),new i(e))},e.prototype.calulateMillisToRetry=function(){return this.currentBackoffMillis=this.increaseTimeoutFunction(this.currentBackoffMillis),this.logger.verbose(this.constructor.name+": Retrying in "+this.currentBackoffMillis+"ms"),this.currentBackoffMillis},e}();t.RetryResolution=s},function(e,t,n){var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o=n(1),i=n(4),s=n(5),a=n(6),u=n(11),c=n(12),f=n(7),l=n(13),h=n(14),d=n(8),p=function(){function e(e){this.options=e,this.host=e.host.replace(/(\/)+$/,""),this.logger=e.logger||new o.ConsoleLogger,this.websocketTransport=new h.default(this.host),this.httpTransport=new l.default(this.host,e.encrypted),this.sdkProduct=e.sdkProduct||"unknown",this.sdkVersion=e.sdkVersion||"unknown",this.sdkPlatform=navigator?"ReactNative"===navigator.product?"react-native":"web":"node"}return e.prototype.request=function(e,t){var n=this;return e.tokenProvider?e.tokenProvider.fetchToken(t).then(function(t){return void 0!==e.headers?e.headers.Authorization="Bearer "+t:e.headers=((n={}).Authorization="Bearer "+t,n),e;var n}).then(function(e){return n.makeRequest(e)}):this.makeRequest(e)},e.prototype.subscribeResuming=function(e,t,n,o,i,a){var l=c.replaceMissingListenersWithNoOps(n),h=u.subscribeStrategyListenersFromSubscriptionListeners(l),p=!1;return s.createResumingStrategy(o,f.createTokenProvidingStrategy(d.createTransportStrategy(e,this.websocketTransport,this.logger),this.logger,a),this.logger,i)({onEnd:h.onEnd,onError:h.onError,onEvent:h.onEvent,onOpen:function(e){p||(p=!0,h.onOpen(e)),l.onSubscribe()},onRetrying:h.onRetrying},r({},t,this.infoHeaders()))},e.prototype.subscribeNonResuming=function(e,t,n,o,i){var s=c.replaceMissingListenersWithNoOps(n),l=u.subscribeStrategyListenersFromSubscriptionListeners(s),h=!1;return a.createRetryingStrategy(o,f.createTokenProvidingStrategy(d.createTransportStrategy(e,this.websocketTransport,this.logger),this.logger,i),this.logger)({onEnd:l.onEnd,onError:l.onError,onEvent:l.onEvent,onOpen:function(e){h||(h=!0,l.onOpen(e)),s.onSubscribe()},onRetrying:l.onRetrying},r({},t,this.infoHeaders()))},e.prototype.infoHeaders=function(){return{"X-SDK-Language":"javascript","X-SDK-Platform":this.sdkPlatform,"X-SDK-Product":this.sdkProduct,"X-SDK-Version":this.sdkVersion}},e.prototype.makeRequest=function(e){var t=this;return i.executeNetworkRequest(function(){return t.httpTransport.request(r({},e,{headers:r({},e.headers,t.infoHeaders())}))},e).catch(function(e){throw t.logger.error(e),e})},e}();t.BaseClient=p},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);function o(e,t,n){return e.onreadystatechange=function(){4===e.readyState&&(e.status>=200&&e.status<300?t(e.response):0!==e.status?n(r.ErrorResponse.fromXHR(e)):n(new r.NetworkError("No Connection")))},e}t.executeNetworkRequest=function(e,t){return new Promise(function(n,r){!function(e,t){t.json?e.send(JSON.stringify(t.json)):e.send(t.body)}(o(e(),n,r),t)})},t.sendRawRequest=function(e){return new Promise(function(t,n){var r=o(new window.XMLHttpRequest,t,n);if(r.open(e.method.toUpperCase(),e.url,!0),e.headers)for(var i in e.headers)e.headers.hasOwnProperty(i)&&r.setRequestHeader(i,e.headers[i]);r.send(e.body)})}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(2);t.createResumingStrategy=function(e,t,n,r){var s=o.createRetryStrategyOptionsOrDefault(e),a=new o.RetryResolution(s,n);return function(e,r){return new i(n,r,t,e,a)}};var i=function(e,t,n,r,o){var i=this;this.unsubscribe=function(){i.state.unsubscribe()},this.onTransition=function(e){i.state=e},this.state=new s(this.onTransition,e,t,n,r,o)},s=function(){function e(e,t,n,r,o,i,s){var c=this;this.onTransition=e,this.logger=t,this.headers=n,this.nextSubscribeStrategy=r,this.listeners=o,this.retryResolution=i,this.initialEventId=s;var l=s;t.verbose("ResumingSubscription: transitioning to OpeningSubscriptionState"),l&&(n["Last-Event-Id"]=l,t.verbose("ResumingSubscription: initialEventId is "+l)),this.underlyingSubscription=r({onEnd:function(n){e(new f(t,o,n))},onError:function(s){e(new u(s,e,t,n,o,r,i,l))},onEvent:function(e){l=e.eventId,o.onEvent(e)},onOpen:function(n){e(new a(t,n,o,c.underlyingSubscription,e))},onRetrying:o.onRetrying},n)}return e.prototype.unsubscribe=function(){this.onTransition(new c(this.logger)),this.underlyingSubscription.unsubscribe()},e}(),a=function(){function e(e,t,n,r,o){this.logger=e,this.headers=t,this.listeners=n,this.underlyingSubscription=r,this.onTransition=o,e.verbose("ResumingSubscription: transitioning to OpenSubscriptionState"),n.onOpen(t)}return e.prototype.unsubscribe=function(){this.onTransition(new c(this.logger)),this.underlyingSubscription.unsubscribe()},e}(),u=function(){function e(e,t,n,i,s,u,c,h){var d=this;this.onTransition=t,this.logger=n,this.headers=i,this.listeners=s,this.nextSubscribeStrategy=u,this.retryResolution=c,n.verbose("ResumingSubscription: transitioning to ResumingSubscriptionState");var p=function(e,i){s.onRetrying();var a,u=((a=e)instanceof r.ErrorResponse&&(a.headers["Request-Method"]="SUBSCRIBE"),c.attemptRetry(a));u instanceof o.Retry?d.timeout=window.setTimeout(function(){g(i)},u.waitTimeMillis):t(new l(n,s,e))},g=function(e){n.verbose("ResumingSubscription: trying to re-establish the subscription"),e&&(n.verbose("ResumingSubscription: lastEventId: "+e),i["Last-Event-Id"]=e),d.underlyingSubscription=u({onEnd:function(e){t(new f(n,s,e))},onError:function(e){p(e,h)},onEvent:function(e){h=e.eventId,s.onEvent(e)},onOpen:function(e){t(new a(n,e,s,d.underlyingSubscription,t))},onRetrying:s.onRetrying},i)};p(e,h)}return e.prototype.unsubscribe=function(){this.onTransition(new c(this.logger)),window.clearTimeout(this.timeout),this.underlyingSubscription.unsubscribe()},e}(),c=function(){function e(e,t){this.logger=e,e.verbose("ResumingSubscription: transitioning to EndingSubscriptionState")}return e.prototype.unsubscribe=function(){throw new Error("Subscription is already ending")},e}(),f=function(){function e(e,t,n){this.logger=e,this.listeners=t,e.verbose("ResumingSubscription: transitioning to EndedSubscriptionState"),t.onEnd(n)}return e.prototype.unsubscribe=function(){throw new Error("Subscription has already ended")},e}(),l=function(){function e(e,t,n){this.logger=e,this.listeners=t,e.verbose("ResumingSubscription: transitioning to FailedSubscriptionState",n),t.onError(n)}return e.prototype.unsubscribe=function(){throw new Error("Subscription has already ended")},e}()},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0),o=n(2);t.createRetryingStrategy=function(e,t,n){var r=o.createRetryStrategyOptionsOrDefault(e),s=new o.RetryResolution(r,n);return function(e,r){return new i(n,r,e,t,s)}};var i=function(e,t,n,r,o){var i=this;this.unsubscribe=function(){i.state.unsubscribe()},this.onTransition=function(e){i.state=e},this.state=new s(this.onTransition,e,t,n,r,o)},s=function(){function e(e,t,n,r,o,i){var s=this;this.logger=t,this.headers=n,this.listeners=r,this.nextSubscribeStrategy=o,this.retryResolution=i,t.verbose("RetryingSubscription: transitioning to OpeningSubscriptionState"),this.underlyingSubscription=o({onEnd:function(n){return e(new c(t,r,n))},onError:function(s){return e(new a(s,e,t,n,r,o,i))},onEvent:r.onEvent,onOpen:function(n){return e(new u(t,r,n,s.underlyingSubscription,e))},onRetrying:r.onRetrying},n)}return e.prototype.unsubscribe=function(){throw this.underlyingSubscription.unsubscribe(),new Error("Method not implemented.")},e}(),a=function(){function e(e,t,n,i,s,a,l){var h=this;this.onTransition=t,this.logger=n,this.headers=i,this.listeners=s,this.nextSubscribeStrategy=a,this.retryResolution=l,n.verbose("RetryingSubscription: transitioning to RetryingSubscriptionState");var d=function(e){s.onRetrying();var i,a=((i=e)instanceof r.ErrorResponse&&(i.headers["Request-Method"]="SUBSCRIBE"),l.attemptRetry(i));a instanceof o.Retry?h.timeout=window.setTimeout(function(){p()},a.waitTimeMillis):t(new f(n,s,e))},p=function(){n.verbose("RetryingSubscription: trying to re-establish the subscription");var e=a({onEnd:function(e){return t(new c(n,s,e))},onError:function(e){return d(e)},onEvent:s.onEvent,onOpen:function(r){t(new u(n,s,r,e,t))},onRetrying:s.onRetrying},i)};d(e)}return e.prototype.unsubscribe=function(){window.clearTimeout(this.timeout),this.onTransition(new c(this.logger,this.listeners))},e}(),u=function(){function e(e,t,n,r,o){this.logger=e,this.listeners=t,this.headers=n,this.underlyingSubscription=r,this.onTransition=o,e.verbose("RetryingSubscription: transitioning to OpenSubscriptionState"),t.onOpen(n)}return e.prototype.unsubscribe=function(){this.underlyingSubscription.unsubscribe(),this.onTransition(new c(this.logger,this.listeners))},e}(),c=function(){function e(e,t,n){this.logger=e,this.listeners=t,e.verbose("RetryingSubscription: transitioning to EndedSubscriptionState"),t.onEnd(n)}return e.prototype.unsubscribe=function(){throw new Error("Subscription has already ended")},e}(),f=function(){function e(e,t,n){this.logger=e,this.listeners=t,e.verbose("RetryingSubscription: transitioning to FailedSubscriptionState",n),t.onError(n)}return e.prototype.unsubscribe=function(){throw new Error("Subscription has already ended")},e}()},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.createTokenProvidingStrategy=function(e,t,n){return n?function(r,i){return new o(t,r,i,n,e)}:e};var o=function(){function e(e,t,n,r,o){var a=this;this.logger=e,this.listeners=t,this.headers=n,this.tokenProvider=r,this.nextSubscribeStrategy=o,this.unsubscribe=function(){a.state.unsubscribe(),a.state=new s(a.logger)},this.state=new i(e,n,o),this.subscribe()}return e.prototype.subscribe=function(){var e=this;this.tokenProvider.fetchToken().then(function(t){var n=Object.assign({},e.listeners);e.state.subscribe(t,{onEnd:function(t){e.state=new s(e.logger),n.onEnd(t)},onError:function(r){e.isTokenExpiredError(r)?(e.tokenProvider.clearToken(t),e.subscribe()):(e.state=new s(e.logger),n.onError(r))},onEvent:e.listeners.onEvent,onOpen:e.listeners.onOpen})}).catch(function(t){e.logger.debug("TokenProvidingSubscription: error when fetching token:",t),e.state=new s(e.logger),e.listeners.onError(t)})},e.prototype.isTokenExpiredError=function(e){return e instanceof r.ErrorResponse&&401===e.statusCode&&"authentication/expired"===e.info},e}(),i=function(){function e(e,t,n){this.logger=e,this.headers=t,this.nextSubscribeStrategy=n,e.verbose("TokenProvidingSubscription: transitioning to ActiveState")}return e.prototype.subscribe=function(e,t){var n=this;this.putTokenIntoHeader(e),this.underlyingSubscription=this.nextSubscribeStrategy({onEnd:function(e){n.logger.verbose("TokenProvidingSubscription: subscription ended"),t.onEnd(e)},onError:function(e){n.logger.verbose("TokenProvidingSubscription: subscription errored:",e),t.onError(e)},onEvent:t.onEvent,onOpen:function(e){n.logger.verbose("TokenProvidingSubscription: subscription opened"),t.onOpen(e)},onRetrying:t.onRetrying},this.headers)},e.prototype.unsubscribe=function(){this.underlyingSubscription.unsubscribe()},e.prototype.putTokenIntoHeader=function(e){this.headers.Authorization="Bearer "+e,this.logger.verbose("TokenProvidingSubscription: token fetched: "+e)},e}(),s=function(){function e(e){this.logger=e,e.verbose("TokenProvidingSubscription: transitioning to InactiveState")}return e.prototype.subscribe=function(e,t){this.logger.verbose("TokenProvidingSubscription: subscribe called in Inactive state; doing nothing")},e.prototype.unsubscribe=function(){this.logger.verbose("TokenProvidingSubscription: unsubscribe called in Inactive state; doing nothing")},e}()},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.createTransportStrategy=function(e,t,n){return function(n,r){return t.subscribe(e,n,r)}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.HOST_BASE="pusherplatform.io"},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(3);t.BaseClient=r.BaseClient;var o=n(9);t.HOST_BASE=o.HOST_BASE;var i=n(15);t.Instance=i.default;var s=n(1);t.ConsoleLogger=s.ConsoleLogger,t.EmptyLogger=s.EmptyLogger;var a=n(0);t.ErrorResponse=a.ErrorResponse,t.NetworkError=a.NetworkError,t.responseToHeadersObject=a.responseToHeadersObject,t.XhrReadyState=a.XhrReadyState;var u=n(4);t.executeNetworkRequest=u.executeNetworkRequest,t.sendRawRequest=u.sendRawRequest;var c=n(5);t.createResumingStrategy=c.createResumingStrategy;var f=n(2);t.createRetryStrategyOptionsOrDefault=f.createRetryStrategyOptionsOrDefault,t.DoNotRetry=f.DoNotRetry,t.Retry=f.Retry,t.RetryResolution=f.RetryResolution;var l=n(6);t.createRetryingStrategy=l.createRetryingStrategy;var h=n(7);t.createTokenProvidingStrategy=h.createTokenProvidingStrategy;var d=n(8);t.createTransportStrategy=d.createTransportStrategy,t.default={BaseClient:r.BaseClient,ConsoleLogger:s.ConsoleLogger,EmptyLogger:s.EmptyLogger,Instance:i.default}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.subscribeStrategyListenersFromSubscriptionListeners=function(e){return{onEnd:e.onEnd,onError:e.onError,onEvent:e.onEvent,onOpen:e.onOpen,onRetrying:e.onRetrying}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.replaceMissingListenersWithNoOps=function(e){return{onEnd:e.onEnd||function(e){},onError:e.onError||function(e){},onEvent:e.onEvent||function(e){},onOpen:e.onOpen||function(e){},onRetrying:e.onRetrying||function(){},onSubscribe:e.onSubscribe||function(){}}}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0);!function(e){e[e.UNOPENED=0]="UNOPENED",e[e.OPENING=1]="OPENING",e[e.OPEN=2]="OPEN",e[e.ENDING=3]="ENDING",e[e.ENDED=4]="ENDED"}(r=t.HttpTransportState||(t.HttpTransportState={}));var i=function(){function e(e,t){var n=this;return this.gotEOS=!1,this.lastNewlineIndex=0,this.state=r.UNOPENED,this.xhr=e,this.listeners=t,this.xhr.onreadystatechange=function(){switch(n.xhr.readyState){case o.XhrReadyState.UNSENT:case o.XhrReadyState.OPENED:case o.XhrReadyState.HEADERS_RECEIVED:n.assertStateIsIn(r.OPENING);break;case o.XhrReadyState.LOADING:n.onLoading();break;case o.XhrReadyState.DONE:n.onDone()}},this.state=r.OPENING,this.xhr.send(),this}return e.prototype.unsubscribe=function(){this.state=r.ENDED,this.xhr.abort(),this.listeners.onEnd&&this.listeners.onEnd(null)},e.prototype.onLoading=function(){if(this.assertStateIsIn(r.OPENING,r.OPEN,r.ENDING),200===this.xhr.status){this.state===r.OPENING&&(this.state=r.OPEN,window.console.log(o.responseToHeadersObject(this.xhr.getAllResponseHeaders())),this.listeners.onOpen&&this.listeners.onOpen(o.responseToHeadersObject(this.xhr.getAllResponseHeaders()))),this.assertStateIsIn(r.OPEN);var e=this.onChunk();this.assertStateIsIn(r.OPEN,r.ENDING),e&&(this.state=r.ENDED,e instanceof o.ErrorResponse&&204!==e.statusCode&&this.listeners.onError&&this.listeners.onError(e))}},e.prototype.onDone=function(){if(200===this.xhr.status){this.state===r.OPENING&&(this.state=r.OPEN,this.listeners.onOpen&&this.listeners.onOpen(o.responseToHeadersObject(this.xhr.getAllResponseHeaders()))),this.assertStateIsIn(r.OPEN,r.ENDING);var e=this.onChunk();e?(this.state=r.ENDED,204===e.statusCode?this.listeners.onEnd&&this.listeners.onEnd(null):this.listeners.onError&&this.listeners.onError(e)):this.state<=r.ENDING?this.listeners.onError&&this.listeners.onError(new Error("HTTP response ended without receiving EOS message")):this.listeners.onEnd&&this.listeners.onEnd(null)}else{if(this.assertStateIsIn(r.OPENING,r.OPEN,r.ENDED),this.state===r.ENDED)return;0===this.xhr.status?this.listeners.onError&&this.listeners.onError(new o.NetworkError("Connection lost.")):this.listeners.onError&&this.listeners.onError(o.ErrorResponse.fromXHR(this.xhr))}},e.prototype.onChunk=function(){this.assertStateIsIn(r.OPEN);var e=this.xhr.responseText,t=e.lastIndexOf("\n");if(t>this.lastNewlineIndex){var n=e.slice(this.lastNewlineIndex,t).split("\n");this.lastNewlineIndex=t;for(var o=0,i=n;o<i.length;o++){var s=i[o];if(0!==s.length){var a=JSON.parse(s),u=this.onMessage(a);if(null!=u)return u}}}},e.prototype.assertStateIsIn=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!t.some(function(t){return t===e.state})){var o=t.map(function(e){return r[e]}).join(", "),i=r[this.state];window.console.warn("Expected this.state to be one of ["+o+"] but it is "+i)}},e.prototype.onMessage=function(e){switch(this.assertStateIsIn(r.OPEN),this.verifyMessage(e),e[0]){case 0:return null;case 1:return this.onEventMessage(e);case 255:return this.onEOSMessage(e);default:return new Error("Unknown Message: "+JSON.stringify(e))}},e.prototype.onEventMessage=function(e){if(this.assertStateIsIn(r.OPEN),4!==e.length)return new Error("Event message has "+e.length+" elements (expected 4)");e[0];var t=e[1],n=e[2],o=e[3];return"string"!=typeof t?new Error("Invalid event ID in message: "+JSON.stringify(e)):"object"!=typeof n||Array.isArray(n)?new Error("Invalid event headers in message: "+JSON.stringify(e)):(this.listeners.onEvent&&this.listeners.onEvent({body:o,headers:n,eventId:t}),null)},e.prototype.onEOSMessage=function(e){if(this.assertStateIsIn(r.OPEN),4!==e.length)return new Error("EOS message has "+e.length+" elements (expected 4)");e[0];var t=e[1],n=e[2],i=e[3];return"number"!=typeof t?new Error("Invalid EOS Status Code"):"object"!=typeof n||Array.isArray(n)?new Error("Invalid EOS ElementsHeaders"):(this.state=r.ENDING,new o.ErrorResponse(t,n,i))},e.prototype.verifyMessage=function(e){return this.gotEOS?new Error("Got another message after EOS message"):Array.isArray(e)?e.length<1?new Error("Message is empty array"):void 0:new Error("Message is not an array")},e}(),s=function(){function e(e,t){void 0===t&&(t=!0),this.baseURL=(t?"https":"http")+"://"+e}return e.prototype.request=function(e){return this.createXHR(this.baseURL,e)},e.prototype.subscribe=function(e,t,n){var r={headers:n,method:"SUBSCRIBE",path:e};return new i(this.createXHR(this.baseURL,r),t)},e.prototype.createXHR=function(e,t){var n=new window.XMLHttpRequest,r=e+"/"+t.path.replace(/^\/+/,"");if(n.open(t.method.toUpperCase(),r,!0),n=this.setJSONHeaderIfAppropriate(n,t),t.jwt&&n.setRequestHeader("authorization","Bearer "+t.jwt),t.headers)for(var o in t.headers)t.headers.hasOwnProperty(o)&&n.setRequestHeader(o,t.headers[o]);return n},e.prototype.setJSONHeaderIfAppropriate=function(e,t){return t.json&&e.setRequestHeader("content-type","application/json"),e},e}();t.default=s},function(e,t,n){var r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};Object.defineProperty(t,"__esModule",{value:!0});var o,i=n(0);!function(e){e[e.Connecting=0]="Connecting",e[e.Open=1]="Open",e[e.Closing=2]="Closing",e[e.Closed=3]="Closed"}(o=t.WSReadyState||(t.WSReadyState={}));var s=function(){function e(){this.subscriptions={}}return e.prototype.add=function(e,t,n,r){return this.subscriptions[e]={headers:r,listeners:n,path:t},e},e.prototype.has=function(e){return void 0!==this.subscriptions[e]},e.prototype.isEmpty=function(){return 0===Object.keys(this.subscriptions).length},e.prototype.remove=function(e){return delete this.subscriptions[e]},e.prototype.get=function(e){return this.subscriptions[e]},e.prototype.getAll=function(){return this.subscriptions},e.prototype.getAllAsArray=function(){var e=this;return Object.keys(this.subscriptions).map(function(t){return r({subID:parseInt(t,10)},e.subscriptions[parseInt(t,10)])})},e.prototype.removeAll=function(){this.subscriptions={}},e}(),a=function(){function e(e,t){this.wsTransport=e,this.subID=t}return e.prototype.unsubscribe=function(){this.wsTransport.unsubscribe(this.subID)},e}(),u=function(){function e(e){this.webSocketPath="/ws",this.forcedClose=!1,this.closedError=null,this.baseURL="wss://"+e+this.webSocketPath,this.lastSubscriptionID=0,this.subscriptions=new s,this.pendingSubscriptions=new s,this.connect()}return e.prototype.subscribe=function(e,t,n){this.tryReconnectIfNeeded();var r=this.lastSubscriptionID++;return this.socket.readyState!==o.Open?(this.pendingSubscriptions.add(r,e,t,n),new a(this,r)):(this.subscriptions.add(r,e,t,n),this.sendMessage(this.getMessage(100,r,e,n)),new a(this,r))},e.prototype.unsubscribe=function(e){this.sendMessage(this.getMessage(198,e));var t=this.subscriptions.get(e);t.listeners.onEnd&&t.listeners.onEnd(null),this.subscriptions.remove(e)},e.prototype.connect=function(){var e=this;this.close(),this.forcedClose=!1,this.closedError=null,this.socket=new window.WebSocket(this.baseURL),this.socket.onopen=function(t){e.pendingSubscriptions.getAllAsArray().forEach(function(t){var n=t.subID,r=t.path,o=t.listeners,i=t.headers;e.subscribePending(r,o,i,n)}),e.pendingSubscriptions.removeAll(),e.pingInterval=window.setInterval(function(){if(!e.pongTimeout){var t=(new Date).getTime();1e4>t-e.lastMessageReceivedTimestamp||(e.sendMessage(e.getMessage(16,t)),e.lastSentPingID=t,e.pongTimeout=window.setTimeout(function(){1e4>(new Date).getTime()-e.lastMessageReceivedTimestamp?e.pongTimeout=null:e.close(new i.NetworkError("Pong response wasn't received until timeout."))},1e4))}},3e4)},this.socket.onmessage=function(t){return e.receiveMessage(t)},this.socket.onerror=function(t){e.close(new i.NetworkError("Connection was lost."))},this.socket.onclose=function(t){if(e.forcedClose){var n=e.closedError?function(t){t.listeners.onError&&t.listeners.onError(e.closedError)}:function(e){e.listeners.onEnd&&e.listeners.onEnd(null)},r=!1===e.pendingSubscriptions.isEmpty()?e.pendingSubscriptions:e.subscriptions;r.getAllAsArray().forEach(n),r.removeAll(),e.closedError&&e.tryReconnectIfNeeded()}else e.tryReconnectIfNeeded()}},e.prototype.close=function(e){this.socket instanceof window.WebSocket&&(this.forcedClose=!0,this.closedError=e,this.socket.close(),window.clearTimeout(this.pingInterval),window.clearTimeout(this.pongTimeout),delete this.pongTimeout,this.lastSentPingID=null)},e.prototype.tryReconnectIfNeeded=function(){this.socket.readyState===o.Closed&&this.connect()},e.prototype.subscribePending=function(e,t,n,r){void 0!==r?(this.subscriptions.add(r,e,t,n),this.sendMessage(this.getMessage(100,r,e,n))):window.console.logger.debug("Subscription to path "+e+" has an undefined ID")},e.prototype.getMessage=function(e,t,n,r){return[e,t,n,r]},e.prototype.sendMessage=function(e){if(this.socket.readyState!==o.Open)return window.console.warn("Can't send in \""+o[this.socket.readyState]+'" state');this.socket.send(JSON.stringify(e))},e.prototype.subscription=function(e){return this.subscriptions.get(e)},e.prototype.receiveMessage=function(e){var t;this.lastMessageReceivedTimestamp=(new Date).getTime();try{t=JSON.parse(e.data)}catch(t){return void this.close(new Error("Message is not valid JSON format. Getting "+e.data))}var n=this.validateMessage(t);if(n)this.close(new Error(n.message));else{var r=t.shift();switch(r){case 17:return void this.onPongMessage(t);case 16:return void this.onPingMessage(t);case 99:return void this.onCloseMessage(t)}var o=t.shift(),i=this.subscription(o);if(i){var s=i.listeners;switch(r){case 101:this.onOpenMessage(t,o,s);break;case 102:this.onEventMessage(t,s);break;case 199:this.onEOSMessage(t,o,s);break;default:this.close(new Error("Received non existing type of message."))}}else this.close(new Error('Received message for non existing subscription id: "'+o+'"'))}},e.prototype.validateMessage=function(e){return Array.isArray(e)?e.length<1?new Error("Message is empty array: "+JSON.stringify(e)):null:new Error("Message is expected to be an array. Getting: "+JSON.stringify(e))},e.prototype.onOpenMessage=function(e,t,n){n.onOpen&&n.onOpen(e[1])},e.prototype.onEventMessage=function(e,t){if(3!==e.length)return new Error("Event message has "+e.length+" elements (expected 4)");var n=e[0],r=e[1],o=e[2];return"string"!=typeof n?new Error("Invalid event ID in message: "+JSON.stringify(e)):"object"!=typeof r||Array.isArray(r)?new Error("Invalid event headers in message: "+JSON.stringify(e)):void(t.onEvent&&t.onEvent({eventId:n,headers:r,body:o}))},e.prototype.onEOSMessage=function(e,t,n){if(this.subscriptions.remove(t),3===e.length){var r=e[0],o=e[1],s=e[2];"number"==typeof r?"object"!=typeof o||Array.isArray(o)?n.onError&&n.onError(new Error("Invalid EOS ElementsHeaders")):204!==r?n.onError&&n.onError(new i.ErrorResponse(r,o,s)):n.onEnd&&n.onEnd(null):n.onError&&n.onError(new Error("Invalid EOS Status Code"))}else n.onError&&n.onError(new Error("EOS message has "+e.length+" elements (expected 4)"))},e.prototype.onCloseMessage=function(e){var t=e[0],n=e[1];return e[2],"number"!=typeof t?this.close(new Error("Close message: Invalid EOS Status Code")):"object"!=typeof n||Array.isArray(n)?this.close(new Error("Close message: Invalid EOS ElementsHeaders")):void this.close()},e.prototype.onPongMessage=function(e){var t=e[0];this.lastSentPingID!==t&&this.close(new i.NetworkError("Didn't received pong with proper ID")),window.clearTimeout(this.pongTimeout),delete this.pongTimeout,this.lastSentPingID=null},e.prototype.onPingMessage=function(e){var t=e[0];this.sendMessage(this.getMessage(17,t))},e}();t.default=u},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(3),o=n(9),i=n(1),s=function(){function e(e){if(!e.locator)throw new Error("Expected `locator` property in Instance options!");var t=e.locator.split(":");if(3!==t.length)throw new Error("The instance locator supplied is invalid. Did you copy it correctly from the Pusher dashboard?");if(!e.serviceName)throw new Error("Expected `serviceName` property in Instance options!");if(!e.serviceVersion)throw new Error("Expected `serviceVersion` property in Instance options!");this.platformVersion=t[0],this.cluster=t[1],this.id=t[2],this.serviceName=e.serviceName,this.serviceVersion=e.serviceVersion,this.host=e.host||this.cluster+"."+o.HOST_BASE,this.logger=e.logger||new i.ConsoleLogger,this.client=e.client||new r.BaseClient({encrypted:e.encrypted,host:this.host,logger:this.logger}),this.tokenProvider=e.tokenProvider}return e.prototype.request=function(e,t){return e.path=this.absPath(e.path),null!=e.headers&&void 0!==e.headers||(e.headers={}),e.tokenProvider=e.tokenProvider||this.tokenProvider,this.client.request(e,t)},e.prototype.subscribeNonResuming=function(e){var t=e.headers||{},n=e.retryStrategyOptions||{},r=e.tokenProvider||this.tokenProvider;return this.client.subscribeNonResuming(this.absPath(e.path),t,e.listeners,n,r)},e.prototype.subscribeResuming=function(e){var t=e.headers||{},n=e.retryStrategyOptions||{},r=e.tokenProvider||this.tokenProvider;return this.client.subscribeResuming(this.absPath(e.path),t,e.listeners,n,e.initialEventId,r)},e.prototype.absPath=function(e){return("/services/"+this.serviceName+"/"+this.serviceVersion+"/"+this.id+"/"+e).replace(/\/+/g,"/").replace(/\/+$/,"")},e}();t.default=s}])},e.exports=n()}(e={exports:{}}),e.exports);(n=r)&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")&&n.default;var o=r.BaseClient,i=r.HOST_BASE,s=r.Instance,a=r.sendRawRequest;function u(e){return null!=e&&"object"==typeof e&&!0===e["@@functional/placeholder"]}function c(e){return function t(n){return 0===arguments.length||u(n)?t:e.apply(this,arguments)}}function f(e){return function t(n,r){switch(arguments.length){case 0:return t;case 1:return u(n)?t:c(function(t){return e(n,t)});default:return u(n)&&u(r)?t:u(n)?c(function(t){return e(t,r)}):u(r)?c(function(t){return e(n,t)}):e(n,r)}}}function l(e,t){switch(e){case 0:return function(){return t.apply(this,arguments)};case 1:return function(e){return t.apply(this,arguments)};case 2:return function(e,n){return t.apply(this,arguments)};case 3:return function(e,n,r){return t.apply(this,arguments)};case 4:return function(e,n,r,o){return t.apply(this,arguments)};case 5:return function(e,n,r,o,i){return t.apply(this,arguments)};case 6:return function(e,n,r,o,i,s){return t.apply(this,arguments)};case 7:return function(e,n,r,o,i,s,a){return t.apply(this,arguments)};case 8:return function(e,n,r,o,i,s,a,u){return t.apply(this,arguments)};case 9:return function(e,n,r,o,i,s,a,u,c){return t.apply(this,arguments)};case 10:return function(e,n,r,o,i,s,a,u,c,f){return t.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function h(e,t,n){return function(){for(var r=[],o=0,i=e,s=0;s<t.length||o<arguments.length;){var a;s<t.length&&(!u(t[s])||o>=arguments.length)?a=t[s]:(a=arguments[o],o+=1),r[s]=a,u(a)||(i-=1),s+=1}return i<=0?n.apply(this,r):l(i,h(e,r,n))}}var d=f(function(e,t){return 1===e?c(t):l(e,h(e,[],t))});function p(e){return function t(n,r,o){switch(arguments.length){case 0:return t;case 1:return u(n)?t:f(function(t,r){return e(n,t,r)});case 2:return u(n)&&u(r)?t:u(n)?f(function(t,n){return e(t,r,n)}):u(r)?f(function(t,r){return e(n,t,r)}):c(function(t){return e(n,r,t)});default:return u(n)&&u(r)&&u(o)?t:u(n)&&u(r)?f(function(t,n){return e(t,n,o)}):u(n)&&u(o)?f(function(t,n){return e(t,r,n)}):u(r)&&u(o)?f(function(t,r){return e(n,t,r)}):u(n)?c(function(t){return e(t,r,o)}):u(r)?c(function(t){return e(n,t,o)}):u(o)?c(function(t){return e(n,r,t)}):e(n,r,o)}}}var g=Array.isArray||function(e){return null!=e&&e.length>=0&&"[object Array]"===Object.prototype.toString.call(e)};function m(e,t,n){return function(){if(0===arguments.length)return n();var r=Array.prototype.slice.call(arguments,0),o=r.pop();if(!g(o)){for(var i=0;i<e.length;){if("function"==typeof o[e[i]])return o[e[i]].apply(o,r);i+=1}if(function(e){return"function"==typeof e["@@transducer/step"]}(o))return t.apply(null,r)(o)}return n.apply(this,arguments)}}var b={init:function(){return this.xf["@@transducer/init"]()},result:function(e){return this.xf["@@transducer/result"](e)}},v=f(function(e,t){return t>e?t:e});function y(e,t){for(var n=0,r=t.length,o=Array(r);n<r;)o[n]=e(t[n]),n+=1;return o}function A(e){return"[object String]"===Object.prototype.toString.call(e)}var w=c(function(e){return!!g(e)||!!e&&"object"==typeof e&&!A(e)&&(1===e.nodeType?!!e.length:0===e.length||e.length>0&&e.hasOwnProperty(0)&&e.hasOwnProperty(e.length-1))}),S=function(){function e(e){this.f=e}return e.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},e.prototype["@@transducer/result"]=function(e){return e},e.prototype["@@transducer/step"]=function(e,t){return this.f(e,t)},e}(),I=f(function(e,t){return l(e.length,function(){return e.apply(t,arguments)})});function M(e,t,n){for(var r=n.next();!r.done;){if((t=e["@@transducer/step"](t,r.value))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}r=n.next()}return e["@@transducer/result"](t)}function E(e,t,n,r){return e["@@transducer/result"](n[r](I(e["@@transducer/step"],e),t))}var x="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";function j(e,t,n){if("function"==typeof e&&(e=function(e){return new S(e)}(e)),w(n))return function(e,t,n){for(var r=0,o=n.length;r<o;){if((t=e["@@transducer/step"](t,n[r]))&&t["@@transducer/reduced"]){t=t["@@transducer/value"];break}r+=1}return e["@@transducer/result"](t)}(e,t,n);if("function"==typeof n["fantasy-land/reduce"])return E(e,t,n,"fantasy-land/reduce");if(null!=n[x])return M(e,t,n[x]());if("function"==typeof n.next)return M(e,t,n);if("function"==typeof n.reduce)return E(e,t,n,"reduce");throw new TypeError("reduce: list must be array or iterable")}var O=function(){function e(e,t){this.xf=t,this.f=e}return e.prototype["@@transducer/init"]=b.init,e.prototype["@@transducer/result"]=b.result,e.prototype["@@transducer/step"]=function(e,t){return this.xf["@@transducer/step"](e,this.f(t))},e}(),N=f(function(e,t){return new O(e,t)});function _(e,t){return Object.prototype.hasOwnProperty.call(t,e)}var T=Object.prototype.toString,V=function(){return"[object Arguments]"===T.call(arguments)?function(e){return"[object Arguments]"===T.call(e)}:function(e){return _("callee",e)}},k=!{toString:null}.propertyIsEnumerable("toString"),R=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],D=function(){return arguments.propertyIsEnumerable("length")}(),L=function(e,t){for(var n=0;n<e.length;){if(e[n]===t)return!0;n+=1}return!1},C=c("function"!=typeof Object.keys||D?function(e){if(Object(e)!==e)return[];var t,n,r=[],o=D&&V(e);for(t in e)!_(t,e)||o&&"length"===t||(r[r.length]=t);if(k)for(n=R.length-1;n>=0;)_(t=R[n],e)&&!L(r,t)&&(r[r.length]=t),n-=1;return r}:function(e){return Object(e)!==e?[]:Object.keys(e)}),P=f(m(["fantasy-land/map","map"],N,function(e,t){switch(Object.prototype.toString.call(t)){case"[object Function]":return d(t.length,function(){return e.call(this,t.apply(this,arguments))});case"[object Object]":return j(function(n,r){return n[r]=e(t[r]),n},{},C(t));default:return y(e,t)}})),U=f(function(e,t){for(var n=t,r=0;r<e.length;){if(null==n)return;n=n[e[r]],r+=1}return n}),z=f(function(e,t){return U([e],t)}),B=p(j),q=f(function(e,t){return function(e,t){var n;e=e||[],t=t||[];var r=e.length,o=t.length,i=[];for(n=0;n<r;)i[i.length]=e[n],n+=1;for(n=0;n<o;)i[i.length]=t[n],n+=1;return i}(t,[e])}),H=c(function(e){for(var t=C(e),n=t.length,r=[],o=0;o<n;)r[o]=e[t[o]],o+=1;return r}),G=c(function(e){return d(e.length,e)}),Q=f(m(["fantasy-land/chain","chain"],f(function(e,t){return P(e,function(e){var t=function(e){return{"@@transducer/init":b.init,"@@transducer/result":function(t){return e["@@transducer/result"](t)},"@@transducer/step":function(t,n){var r=e["@@transducer/step"](t,n);return r["@@transducer/reduced"]?{"@@transducer/value":r,"@@transducer/reduced":!0}:r}}}(e);return{"@@transducer/init":b.init,"@@transducer/result":function(e){return t["@@transducer/result"](e)},"@@transducer/step":function(e,n){return w(n)?j(t,e,n):j(t,e,[n])}}}(t))}),function(e,t){return"function"==typeof t?function(n){return e(t(n))(n)}:function(e){for(var t,n,r,o=[],i=0,s=e.length;i<s;){if(w(e[i]))for(r=0,n=(t=e[i]).length;r<n;)o[o.length]=t[r],r+=1;else o[o.length]=e[i];i+=1}return o}(P(e,t))})),Z=c(function(e){return null===e?"Null":void 0===e?"Undefined":Object.prototype.toString.call(e).slice(8,-1)});function F(e,t){return function(){return t.call(this,e.apply(this,arguments))}}function Y(e,t){return function(){var n=arguments.length;if(0===n)return t();var r=arguments[n-1];return g(r)||"function"!=typeof r[e]?t.apply(this,arguments):r[e].apply(r,Array.prototype.slice.call(arguments,0,n-1))}}var J=c(Y("tail",p(Y("slice",function(e,t,n){return Array.prototype.slice.call(n,e,t)}))(1,1/0)));function X(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return l(arguments[0].length,B(F,arguments[0],J(arguments)))}var W=c(function(e){return A(e)?e.split("").reverse().join(""):Array.prototype.slice.call(e,0).reverse()});function K(){if(0===arguments.length)throw new Error("compose requires at least one argument");return X.apply(this,W(arguments))}function $(e){for(var t,n=[];!(t=e.next()).done;)n.push(t.value);return n}function ee(e,t,n){for(var r=0,o=n.length;r<o;){if(e(t,n[r]))return!0;r+=1}return!1}var te=f(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t});function ne(e,t,n,r){var o=$(e);function i(e,t){return re(e,t,n.slice(),r.slice())}return!ee(function(e,t){return!ee(i,t,e)},$(t),o)}function re(e,t,n,r){if(te(e,t))return!0;var o,i,s=Z(e);if(s!==Z(t))return!1;if(null==e||null==t)return!1;if("function"==typeof e["fantasy-land/equals"]||"function"==typeof t["fantasy-land/equals"])return"function"==typeof e["fantasy-land/equals"]&&e["fantasy-land/equals"](t)&&"function"==typeof t["fantasy-land/equals"]&&t["fantasy-land/equals"](e);if("function"==typeof e.equals||"function"==typeof t.equals)return"function"==typeof e.equals&&e.equals(t)&&"function"==typeof t.equals&&t.equals(e);switch(s){case"Arguments":case"Array":case"Object":if("function"==typeof e.constructor&&"Promise"===(o=e.constructor,null==(i=String(o).match(/^function (\w*)/))?"":i[1]))return e===t;break;case"Boolean":case"Number":case"String":if(typeof e!=typeof t||!te(e.valueOf(),t.valueOf()))return!1;break;case"Date":if(!te(e.valueOf(),t.valueOf()))return!1;break;case"Error":return e.name===t.name&&e.message===t.message;case"RegExp":if(e.source!==t.source||e.global!==t.global||e.ignoreCase!==t.ignoreCase||e.multiline!==t.multiline||e.sticky!==t.sticky||e.unicode!==t.unicode)return!1}for(var a=n.length-1;a>=0;){if(n[a]===e)return r[a]===t;a-=1}switch(s){case"Map":return e.size===t.size&&ne(e.entries(),t.entries(),n.concat([e]),r.concat([t]));case"Set":return e.size===t.size&&ne(e.values(),t.values(),n.concat([e]),r.concat([t]));case"Arguments":case"Array":case"Object":case"Boolean":case"Number":case"String":case"Date":case"Error":case"RegExp":case"Int8Array":case"Uint8Array":case"Uint8ClampedArray":case"Int16Array":case"Uint16Array":case"Int32Array":case"Uint32Array":case"Float32Array":case"Float64Array":case"ArrayBuffer":break;default:return!1}var u=C(e);if(u.length!==C(t).length)return!1;var c=n.concat([e]),f=r.concat([t]);for(a=u.length-1;a>=0;){var l=u[a];if(!_(l,t)||!re(t[l],e[l],c,f))return!1;a-=1}return!0}var oe=f(function(e,t){return re(e,t,[],[])});function ie(e,t){return function(e,t,n){var r,o;if("function"==typeof e.indexOf)switch(typeof t){case"number":if(0===t){for(r=1/t;n<e.length;){if(0===(o=e[n])&&1/o===r)return n;n+=1}return-1}if(t!=t){for(;n<e.length;){if("number"==typeof(o=e[n])&&o!=o)return n;n+=1}return-1}return e.indexOf(t,n);case"string":case"boolean":case"function":case"undefined":return e.indexOf(t,n);case"object":if(null===t)return e.indexOf(t,n)}for(;n<e.length;){if(oe(e[n],t))return n;n+=1}return-1}(t,e,0)>=0}function se(e){return'"'+e.replace(/\\/g,"\\\\").replace(/[\b]/g,"\\b").replace(/\f/g,"\\f").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\v/g,"\\v").replace(/\0/g,"\\0").replace(/"/g,'\\"')+'"'}var ae=function(e){return(e<10?"0":"")+e},ue="function"==typeof Date.prototype.toISOString?function(e){return e.toISOString()}:function(e){return e.getUTCFullYear()+"-"+ae(e.getUTCMonth()+1)+"-"+ae(e.getUTCDate())+"T"+ae(e.getUTCHours())+":"+ae(e.getUTCMinutes())+":"+ae(e.getUTCSeconds())+"."+(e.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"};function ce(e){return"[object Object]"===Object.prototype.toString.call(e)}var fe=function(){function e(e,t){this.xf=t,this.f=e}return e.prototype["@@transducer/init"]=b.init,e.prototype["@@transducer/result"]=b.result,e.prototype["@@transducer/step"]=function(e,t){return this.f(t)?this.xf["@@transducer/step"](e,t):e},e}(),le=f(m(["filter"],f(function(e,t){return new fe(e,t)}),function(e,t){return ce(t)?j(function(n,r){return e(t[r])&&(n[r]=t[r]),n},{},C(t)):function(e,t){for(var n=0,r=t.length,o=[];n<r;)e(t[n])&&(o[o.length]=t[n]),n+=1;return o}(e,t)})),he=f(function(e,t){return le((n=e,function(){return!n.apply(this,arguments)}),t);var n}),de=c(function(e){return function e(t,n){var r=function(r){var o=n.concat([t]);return ie(r,o)?"<Circular>":e(r,o)},o=function(e,t){return y(function(t){return se(t)+": "+r(e[t])},t.slice().sort())};switch(Object.prototype.toString.call(t)){case"[object Arguments]":return"(function() { return arguments; }("+y(r,t).join(", ")+"))";case"[object Array]":return"["+y(r,t).concat(o(t,he(function(e){return/^\d+$/.test(e)},C(t)))).join(", ")+"]";case"[object Boolean]":return"object"==typeof t?"new Boolean("+r(t.valueOf())+")":t.toString();case"[object Date]":return"new Date("+(isNaN(t.valueOf())?r(NaN):se(ue(t)))+")";case"[object Null]":return"null";case"[object Number]":return"object"==typeof t?"new Number("+r(t.valueOf())+")":1/t==-1/0?"-0":t.toString(10);case"[object String]":return"object"==typeof t?"new String("+r(t.valueOf())+")":se(t);case"[object Undefined]":return"undefined";default:if("function"==typeof t.toString){var i=t.toString();if("[object Object]"!==i)return i}return"{"+o(t,C(t)).join(", ")+"}"}}(e,[])}),pe=f(ie),ge=function(){function e(e,t,n,r){this.valueFn=e,this.valueAcc=t,this.keyFn=n,this.xf=r,this.inputs={}}return e.prototype["@@transducer/init"]=b.init,e.prototype["@@transducer/result"]=function(e){var t;for(t in this.inputs)if(_(t,this.inputs)&&(e=this.xf["@@transducer/step"](e,this.inputs[t]))["@@transducer/reduced"]){e=e["@@transducer/value"];break}return this.inputs=null,this.xf["@@transducer/result"](e)},e.prototype["@@transducer/step"]=function(e,t){var n=this.keyFn(t);return this.inputs[n]=this.inputs[n]||[n,this.valueAcc],this.inputs[n][1]=this.valueFn(this.inputs[n][1],t),e},e}(),me=h(4,[],m([],h(4,[],function(e,t,n,r){return new ge(e,t,n,r)}),function(e,t,n,r){return j(function(r,o){var i=n(o);return r[i]=e(_(i,r)?r[i]:t,o),r},{},r)})),be=f(function(e,t){for(var n=[],r=0,o=e.length;r<o;)ie(e[r],t)||ie(e[r],n)||(n[n.length]=e[r]),r+=1;return n}),ve=f(function(e,t){var n=e<0?t.length+e:e;return A(t)?t.charAt(n):t[n]}),ye=c(function(e){return null!=e&&"function"==typeof e["fantasy-land/empty"]?e["fantasy-land/empty"]():null!=e&&null!=e.constructor&&"function"==typeof e.constructor["fantasy-land/empty"]?e.constructor["fantasy-land/empty"]():null!=e&&"function"==typeof e.empty?e.empty():null!=e&&null!=e.constructor&&"function"==typeof e.constructor.empty?e.constructor.empty():g(e)?[]:A(e)?"":ce(e)?{}:V(e)?function(){return arguments}():void 0}),Ae=f(Y("forEach",function(e,t){for(var n=t.length,r=0;r<n;)e(t[r]),r+=1;return t})),we=f(function(e,t){for(var n=C(t),r=0;r<n.length;){var o=n[r];e(t[o],o,t),r+=1}return t}),Se=c(function(e){for(var t={},n=0;n<e.length;)t[e[n][0]]=e[n][1],n+=1;return t}),Ie=f(_),Me=ve(0),Ee=c(function(e){return e}),xe=me(function(e,t){return t},null),je=function(){function e(){this._nativeSet="function"==typeof Set?new Set:null,this._items={}}return e.prototype.add=function(e){return!Oe(e,!0,this)},e.prototype.has=function(e){return Oe(e,!1,this)},e}();function Oe(e,t,n){var r,o=typeof e;switch(o){case"string":case"number":return 0===e&&1/e==-1/0?!!n._items["-0"]||(t&&(n._items["-0"]=!0),!1):null!==n._nativeSet?t?(r=n._nativeSet.size,n._nativeSet.add(e),n._nativeSet.size===r):n._nativeSet.has(e):o in n._items?e in n._items[o]||(t&&(n._items[o][e]=!0),!1):(t&&(n._items[o]={},n._items[o][e]=!0),!1);case"boolean":if(o in n._items){var i=e?1:0;return!!n._items[o][i]||(t&&(n._items[o][i]=!0),!1)}return t&&(n._items[o]=e?[!1,!0]:[!0,!1]),!1;case"function":return null!==n._nativeSet?t?(r=n._nativeSet.size,n._nativeSet.add(e),n._nativeSet.size===r):n._nativeSet.has(e):o in n._items?!!ie(e,n._items[o])||(t&&n._items[o].push(e),!1):(t&&(n._items[o]=[e]),!1);case"undefined":return!!n._items[o]||(t&&(n._items[o]=!0),!1);case"object":if(null===e)return!!n._items.null||(t&&(n._items.null=!0),!1);default:return(o=Object.prototype.toString.call(e))in n._items?!!ie(e,n._items[o])||(t&&n._items[o].push(e),!1):(t&&(n._items[o]=[e]),!1)}}var Ne=f(function(e,t){for(var n,r,o=new je,i=[],s=0;s<t.length;)n=e(r=t[s]),o.add(n)&&i.push(r),s+=1;return i})(Ee),_e=f(function(e,t){return d(e+1,function(){var n,r=arguments[e];if(null!=r&&(n=r[t],"[object Function]"===Object.prototype.toString.call(n)))return r[t].apply(r,Array.prototype.slice.call(arguments,0,e));throw new TypeError(de(r)+' does not have a method named "'+t+'"')})}),Te=c(function(e){return null!=e&&oe(e,ye(e))}),Ve=_e(1,"join"),ke=c(function(e){return null!=e&&(t=e.length,"[object Number]"===Object.prototype.toString.call(t))?e.length:NaN;var t}),Re=f(function(e,t){for(var n={},r=0;r<e.length;)e[r]in t&&(n[e[r]]=t[e[r]]),r+=1;return n}),De=f(function(e,t){return Array.prototype.slice.call(t,0).sort(e)}),Le=_e(1,"split"),Ce=c(function(e){var t=[];for(var n in e)_(n,e)&&(t[t.length]=[n,e[n]]);return t}),Pe=(String.prototype.trim,"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e}),Ue=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},ze=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),Be=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},qe=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n},He=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var s,a=e[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&a.return&&a.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},Ge=X(le(function(e){return void 0!==e}),Ce,P(function(e){var t=He(e,2),n=t[0],r=t[1];return n+"="+encodeURIComponent(r)}),Ve("&")),Qe=function(e,t){return t+(pe("?",t)?"&":"?")+Ge(e)},Ze=X(Le("&"),P(Le("=")),Se),Fe=function(e,t,n){var r=void 0===n?"undefined":Pe(n);if(r!==t)throw new TypeError("expected "+e+" to be of type "+t+" but was of type "+r)},Ye=function(e,t,n){Fe(e,"object",n),we(function(e,n){return Fe(n,t,e)},n)},Je=function(){return Math.floor(Date.now()/1e3)},Xe=function(e){return{createdAt:e.created_at,createdByUserId:e.created_by_id,deletedAt:e.deletedAt,id:e.id,isPrivate:e.private,name:e.name,updatedAt:e.updated_at,userIds:e.member_user_ids}},We=function(e){return{avatarURL:e.avatar_url,createdAt:e.created_at,customData:e.custom_data,id:e.id,name:e.name,updatedAt:e.updated_at}},Ke=function(e){return{lastSeenAt:e.last_seen_at,state:pe(e.state,["online","offline"])?e.state:"unknown",userId:e.user_id}},$e=function(e){return{id:e.id,senderId:e.user_id,roomId:e.room_id,text:e.text,createdAt:e.created_at,updatedAt:e.updated_at,attachment:e.attachment&&nt(e.attachment)}},et=function(e){return{file:{name:e.file.name,bytes:e.file.bytes,lastModified:e.file.last_modified},link:e.resource_link,ttl:e.ttl}},tt=function(e){return{position:e.position,updatedAt:e.updated_at,userId:e.user_id,roomId:e.room_id,type:e.cursor_type}},nt=function(e){return{link:e.resource_link,type:e.type,fetchRequired:"true"===(t=e.resource_link,pe("?",t)?Ze(Le("?",t)[1]):{}).chatkit_link};var t},rt=function e(){var t=this;Ue(this,e),this.pendingSets=[],this.pendingGets=[],this.initialize=function(e){t.store=e,Ae(function(e){var n=e.key,r=e.value;(0,e.resolve)(t.store[n]=r)},t.pendingSets),Ae(function(e){var n=e.key;(0,e.resolve)(t.store[n])},t.pendingGets)},this.set=function(e,n){return t.store?Promise.resolve(t.store[e]=n):new Promise(function(r){t.pendingSets.push({key:e,value:n,resolve:r})})},this.get=function(e){return t.store?Promise.resolve(t.store[e]):new Promise(function(n){t.pendingGets.push({key:e,resolve:n})})},this.pop=function(e){return t.get(e).then(function(n){return delete t.store[e],n})},this.update=function(e,n){return t.get(e).then(function(r){return t.set(e,n(r))})},this.snapshot=function(){return t.store||{}},this.getSync=function(e){return t.store?t.store[e]:void 0}},ot=function(){function e(t,n){Ue(this,e),this.avatarURL=t.avatarURL,this.createdAt=t.createdAt,this.customData=t.customData,this.id=t.id,this.name=t.name,this.updatedAt=t.updatedAt,this.presenceStore=n}return ze(e,[{key:"presence",get:function(){return this.presenceStore.getSync(this.id)||{lastSeenAt:void 0,state:"unknown",userId:this.id}}}]),e}(),it=function e(t){var n=this,r=t.instance,o=t.presenceStore,i=t.logger;Ue(this,e),this.store=new rt,this.initialize=function(e){n.store.initialize(P(n.decorate,e))},this.set=function(e,t){return n.store.set(e,n.decorate(t))},this.get=function(e){return Promise.all([n.fetchUser(e),n.presenceStore.get(e)]).then(function(e){var t=He(e,2),n=t[0];return t[1],n})},this.fetchUser=function(e){return n.fetchMissingUsers([e]).then(function(){return n.store.get(e)})},this.fetchMissingUsers=function(e){var t=be(e,P(z("id"),H(n.store.snapshot()))),r=be(t,C(n.reqs));return ke(r)>0&&n.fetchBasicUsers(r),Promise.all(H(Re(e,n.reqs)))},this.fetchBasicUsers=function(e){var t=n.instance.request({method:"GET",path:Qe({user_ids:Ve(",",e)},"/users_by_ids")}).then(function(t){var r=P(We,JSON.parse(t));return Ae(function(e){return n.set(e.id,e)},r),Ae(function(e){delete n.reqs[e]},e),r}).catch(function(e){throw n.logger.warn("error fetching missing users:",e),e});Ae(function(e){n.reqs[e]=t},e)},this.snapshot=this.store.snapshot,this.getSync=this.store.getSync,this.decorate=function(e){return e?new ot(e,n.presenceStore):void 0},this.instance=r,this.presenceStore=o,this.logger=i,this.reqs={}},st=function(){function e(t,n){Ue(this,e),this.createdAt=t.createdAt,this.createdByUserId=t.createdByUserId,this.deletedAt=t.deletedAt,this.id=t.id,this.isPrivate=t.isPrivate,this.name=t.name,this.updatedAt=t.updatedAt,this.userIds=t.userIds,this.userStore=n}return ze(e,[{key:"users",get:function(){var e=this;return le(function(t){return pe(t.id,e.userIds)},H(this.userStore.snapshot()))}}]),e}(),at=function e(t){var n=this,r=t.instance,o=t.userStore,i=t.logger;Ue(this,e),this.store=new rt,this.initialize=function(e){n.store.initialize(P(n.decorate,e))},this.set=G(function(e,t){return n.store.set(e,n.decorate(t)).then(function(e){return n.userStore.fetchMissingUsers(e.userIds).then(function(){return e})})}),this.get=function(e){return n.store.get(e).then(function(t){return t||n.fetchBasicRoom(e).then(n.set(e))})},this.pop=this.store.pop,this.addUserToRoom=function(e,t){return n.store.update(e,function(e){return e.userIds=Ne(q(t,e.userIds)),e})},this.removeUserFromRoom=function(e,t){return n.store.update(e,function(e){return e.userIds=le(function(e){return e!==t},e.userIds),e})},this.update=function(e,t){return n.store.update(e,function(e){return e.createdAt=t.createdAt||e.createdAt,e.createdByUserId=t.createdByUserId||e.createdByUserId,e.deletedAt=t.deletedAt||e.deletedAt,e.id=t.id||e.id,e.isPrivate=t.isPrivate||e.isPrivate,e.name=t.name||e.name,e.updatedAt=t.updatedAt||e.updatedAt,e.userIds=t.userIds||e.userIds,e})},this.fetchBasicRoom=function(e){return n.instance.request({method:"GET",path:"/rooms/"+e}).then(X(JSON.parse,Xe)).catch(function(t){n.logger.warn("error fetching details for room "+e+":",t)})},this.snapshot=this.store.snapshot,this.getSync=this.store.getSync,this.decorate=function(e){return e?new st(e,n.userStore):void 0},this.instance=r,this.userStore=o,this.logger=i},ut=function(){function e(t,n,r){Ue(this,e),this.position=t.position,this.updatedAt=t.updatedAt,this.userId=t.userId,this.roomId=t.roomId,this.type=t.type,this.userStore=n,this.roomStore=r}return ze(e,[{key:"user",get:function(){return this.userStore.getSync(this.userId)}},{key:"room",get:function(){return this.roomStore.getSync(this.roomId)}}]),e}(),ct=function e(t){var n=this,r=t.instance,o=t.userStore,i=t.roomStore,s=t.logger;Ue(this,e),this.store=new rt,this.initialize=function(e){n.store.initialize(P(n.decorate,e))},this.set=function(e,t,r){return n.store.set(ft(e,t),n.decorate(r))},this.get=function(e,t){return n.store.get(ft(e,t)).then(function(r){return r||n.fetchBasicCursor(e,t).then(function(r){return n.set(e,t,r)})})},this.getSync=function(e,t){return n.store.getSync(ft(e,t))},this.fetchBasicCursor=function(e,t){return n.instance.request({method:"GET",path:"/cursors/0/rooms/"+t+"/users/"+encodeURIComponent(e)}).then(function(e){var t=JSON.parse(e);if(t)return tt(t)}).catch(function(e){throw n.logger.warn("error fetching cursor:",e),e})},this.decorate=function(e){return e?new ut(e,n.userStore,n.roomStore):void 0},this.instance=r,this.userStore=o,this.roomStore=i,this.logger=s},ft=function(e,t){return e+"/"+t},lt=function e(t){var n=this,r=t.hooks,o=t.userId,i=t.instance,s=t.logger;Ue(this,e),this.sendThrottledRequest=function(e){var t=Date.now(),r=n.lastSentRequests[e];return r&&t-r<1e3?Promise.resolve():(n.lastSentRequests[e]=t,n.instance.request({method:"POST",path:"/rooms/"+e+"/events",json:{name:"typing_start",user_id:n.userId}}).catch(function(t){throw delete n.typingRequestSent[e],n.logger.warn("Error sending is_typing event in room "+e,t),t}))},this.onIsTyping=function(e,t){n.timers[e.id]||(n.timers[e.id]={}),n.timers[e.id][t.id]?clearTimeout(n.timers[e.id][t.id]):n.onStarted(e,t),n.timers[e.id][t.id]=setTimeout(function(){n.onStopped(e,t),delete n.timers[e.id][t.id]},1500)},this.onStarted=function(e,t){n.hooks.global.onUserStartedTyping&&n.hooks.global.onUserStartedTyping(e,t),n.hooks.rooms[e.id]&&n.hooks.rooms[e.id].onUserStartedTyping&&n.hooks.rooms[e.id].onUserStartedTyping(t)},this.onStopped=function(e,t){n.hooks.global.onUserStoppedTyping&&n.hooks.global.onUserStoppedTyping(e,t),n.hooks.rooms[e.id]&&n.hooks.rooms[e.id].onUserStoppedTyping&&n.hooks.rooms[e.id].onUserStoppedTyping(t)},this.hooks=r,this.userId=o,this.instance=i,this.logger=s,this.lastSentRequests={},this.timers={}},ht=function(){function e(t){var n=this;Ue(this,e),this.onEvent=function(e){var t=e.body;switch(t.event_name){case"initial_state":n.onInitialState(t.data);break;case"added_to_room":n.onAddedToRoom(t.data);break;case"removed_from_room":n.onRemovedFromRoom(t.data);break;case"user_joined":n.onUserJoined(t.data);break;case"user_left":n.onUserLeft(t.data);break;case"room_updated":n.onRoomUpdated(t.data);break;case"room_deleted":n.onRoomDeleted(t.data);break;case"typing_start":n.onIsTyping(t.data)}},this.onInitialState=function(e){var t=e.current_user,r=e.rooms;n.onSubscriptionEstablished({user:We(t),basicRooms:P(Xe,r)})},this.onAddedToRoom=function(e){var t=e.room,r=Xe(t);n.roomStore.set(r.id,r).then(function(e){n.hooks.global.onAddedToRoom&&n.hooks.global.onAddedToRoom(e)})},this.onRemovedFromRoom=function(e){var t=e.room_id;n.roomStore.pop(t).then(function(e){e&&n.hooks.global.onRemovedFromRoom&&n.hooks.global.onRemovedFromRoom(e)})},this.onUserJoined=function(e){var t=e.room_id,r=e.user_id;n.roomStore.addUserToRoom(t,r).then(function(e){n.userStore.get(r).then(function(r){n.hooks.global.onUserJoinedRoom&&n.hooks.global.onUserJoinedRoom(e,r),n.hooks.rooms[t]&&n.hooks.rooms[t].onUserJoined&&n.hooks.rooms[t].onUserJoined(r)})})},this.onUserLeft=function(e){var t=e.room_id,r=e.user_id;n.roomStore.removeUserFromRoom(t,r).then(function(e){n.userStore.get(r).then(function(r){n.hooks.global.onUserLeftRoom&&n.hooks.global.onUserLeftRoom(e,r),n.hooks.rooms[t]&&n.hooks.rooms[t].onUserLeft&&n.hooks.rooms[t].onUserLeft(r)})})},this.onRoomUpdated=function(e){var t=e.room,r=Xe(t);n.roomStore.update(r.id,r).then(function(e){n.hooks.global.onRoomUpdated&&n.hooks.global.onRoomUpdated(e)})},this.onRoomDeleted=function(e){var t=e.room_id;n.roomStore.pop(t).then(function(e){e&&n.hooks.global.onRoomDeleted&&n.hooks.global.onRoomDeleted(e)})},this.onIsTyping=function(e){var t=e.room_id,r=e.user_id;Promise.all([n.roomStore.get(t),n.userStore.get(r)]).then(function(e){var t=He(e,2),r=t[0],o=t[1];return n.typingIndicators.onIsTyping(r,o)})},this.userId=t.userId,this.hooks=t.hooks,this.instance=t.instance,this.userStore=t.userStore,this.roomStore=t.roomStore,this.typingIndicators=t.typingIndicators,this.roomSubscriptions=t.roomSubscriptions,this.logger=t.logger,this.connectionTimeout=t.connectionTimeout}return ze(e,[{key:"connect",value:function(){var e=this;return new Promise(function(t,n){e.timeout=setTimeout(function(){n(new Error("user subscription timed out"))},e.connectionTimeout),e.onSubscriptionEstablished=function(n){clearTimeout(e.timeout),t(n)},e.sub=e.instance.subscribeNonResuming({path:"/users",listeners:{onError:function(t){clearTimeout(e.timeout),n(t)},onEvent:e.onEvent}})})}},{key:"cancel",value:function(){clearTimeout(this.timeout);try{this.sub&&this.sub.unsubscribe()}catch(e){this.logger.debug("error when cancelling user subscription",e)}}}]),e}(),dt=function(){function e(t){var n=this;Ue(this,e),this.onEvent=function(e){var t=e.body;switch(t.event_name){case"initial_state":n.onInitialState(t.data);break;case"presence_update":n.onPresenceUpdate(t.data);break;case"join_room_presence_update":n.onJoinRoomPresenceUpdate(t.data)}},this.onInitialState=function(e){var t=e.user_states;n.presenceStore.initialize(xe(z("userId"),P(Ke,t))),n.onSubscriptionEstablished()},this.onPresenceUpdate=function(e){var t=Ke(e);n.presenceStore.set(t.userId,t).then(function(e){return n.userStore.get(e.userId).then(function(t){switch(e.state){case"online":n.onCameOnline(t);break;case"offline":n.onWentOffline(t)}})})},this.onJoinRoomPresenceUpdate=function(e){var t=e.user_states;return Ae(function(e){return n.presenceStore.set(e.userId,e)},P(Ke,t))},this.onCameOnline=function(e){return n.callRelevantHooks("onUserCameOnline",e)},this.onWentOffline=function(e){return n.callRelevantHooks("onUserWentOffline",e)},this.callRelevantHooks=function(e,t){n.hooks.global[e]&&n.hooks.global[e](t),K(Ae(function(r){var o=He(r,2),i=o[0],s=o[1];return n.roomStore.get(i).then(function(n){pe(t.id,n.userIds)&&s[e](t)})}),le(function(t){var n=He(t,2);return n[0],void 0!==n[1][e]}),Ce)(n.hooks.rooms)},this.userId=t.userId,this.hooks=t.hooks,this.instance=t.instance,this.userStore=t.userStore,this.roomStore=t.roomStore,this.presenceStore=t.presenceStore,this.logger=t.logger,this.connectionTimeout=t.connectionTimeout}return ze(e,[{key:"connect",value:function(){var e=this;return new Promise(function(t,n){e.timeout=setTimeout(function(){n(new Error("presence subscription timed out"))},e.connectionTimeout),e.onSubscriptionEstablished=function(n){clearTimeout(e.timeout),t(n)},e.sub=e.instance.subscribeNonResuming({path:"/users/"+encodeURIComponent(e.userId)+"/presence",listeners:{onError:function(t){clearTimeout(e.timeout),n(t)},onEvent:e.onEvent}})})}},{key:"cancel",value:function(){clearTimeout(this.timeout);try{this.sub&&this.sub.unsubscribe()}catch(e){this.logger.debug("error when cancelling presence subscription",e)}}}]),e}(),pt=function(){function e(t){var n=this;Ue(this,e),this.onEvent=function(e){var t=e.body;switch(t.event_name){case"initial_state":n.onInitialState(t.data);break;case"new_cursor":n.onNewCursor(t.data)}},this.onInitialState=function(e){var t=e.cursors;K(Ae(function(e){return n.cursorStore.set(e.userId,e.roomId,e)}),P(tt))(t),n.onSubscriptionEstablished()},this.onNewCursor=function(e){var t=tt(e);n.cursorStore.set(t.userId,t.roomId,t).then(function(){n.cursorStore.get(t.userId,t.roomId).then(n.onNewCursorHook)})},this.onNewCursorHook=t.onNewCursorHook,this.path=t.path,this.cursorStore=t.cursorStore,this.instance=t.instance,this.logger=t.logger,this.connectionTimeout=t.connectionTimeout}return ze(e,[{key:"connect",value:function(){var e=this;return new Promise(function(t,n){e.timeout=setTimeout(function(){n(new Error("cursor subscription timed out"))},e.connectionTimeout),e.onSubscriptionEstablished=function(n){clearTimeout(e.timeout),t(n)},e.sub=e.instance.subscribeNonResuming({path:e.path,listeners:{onError:function(t){clearTimeout(e.timeout),n(t)},onEvent:e.onEvent}})})}},{key:"cancel",value:function(){clearTimeout(this.timeout);try{this.sub&&this.sub.unsubscribe()}catch(e){this.logger.debug("error when cancelling cursor subscription",e)}}}]),e}(),gt=function(){function e(t,n,r){Ue(this,e),this.id=t.id,this.senderId=t.senderId,this.roomId=t.roomId,this.text=t.text,this.attachment=t.attachment,this.createdAt=t.createdAt,this.updatedAt=t.updatedAt,this.userStore=n,this.roomStore=r}return ze(e,[{key:"sender",get:function(){return this.userStore.getSync(this.senderId)}},{key:"room",get:function(){return this.roomStore.getSync(this.roomId)}}]),e}(),mt=function(){function e(t){var n=this;Ue(this,e),this.onEvent=function(e){var t=e.body;switch(t.event_name){case"new_message":n.onNewMessage(t.data)}},this.onNewMessage=function(e){var t={message:new gt($e(e),n.userStore,n.roomStore),ready:!1};n.messageBuffer.push(t),n.userStore.fetchMissingUsers([t.message.senderId]).catch(function(e){n.logger.error("error fetching missing user information:",e)}).then(function(){t.ready=!0,n.flushBuffer()})},this.flushBuffer=function(){for(;!Te(n.messageBuffer)&&Me(n.messageBuffer).ready;){var e=n.messageBuffer.shift().message;n.hooks.rooms[n.roomId]&&n.hooks.rooms[n.roomId].onNewMessage&&n.hooks.rooms[n.roomId].onNewMessage(e)}},this.roomId=t.roomId,this.hooks=t.hooks,this.messageLimit=t.messageLimit,this.userId=t.userId,this.instance=t.instance,this.userStore=t.userStore,this.roomStore=t.roomStore,this.messageBuffer=[],this.logger=t.logger}return ze(e,[{key:"connect",value:function(){var e=this;return new Promise(function(t,n){e.sub=e.instance.subscribeResuming({path:"/rooms/"+e.roomId+"?"+Ge({message_limit:e.messageLimit}),listeners:{onOpen:t,onError:n,onEvent:e.onEvent}})})}},{key:"cancel",value:function(){try{this.sub&&this.sub.unsubscribe()}catch(e){this.logger.debug("error when cancelling message subscription",e)}}}]),e}(),bt=function(){function e(t){var n=t.messageSub,r=t.cursorSub;Ue(this,e),this.messageSub=n,this.cursorSub=r}return ze(e,[{key:"cancel",value:function(){this.messageSub.cancel(),this.cursorSub.cancel()}}]),e}(),vt=function(){function e(t){var n=t.apiInstance,r=t.connectionTimeout,o=t.cursorsInstance,i=t.filesInstance,s=t.hooks,a=t.id,u=t.presenceInstance;Ue(this,e),yt.call(this),this.hooks={global:s,rooms:{}},this.id=a,this.encodedId=encodeURIComponent(this.id),this.apiInstance=n,this.filesInstance=i,this.cursorsInstance=o,this.connectionTimeout=r,this.presenceInstance=u,this.logger=n.logger,this.presenceStore=new rt,this.userStore=new it({instance:this.apiInstance,presenceStore:this.presenceStore,logger:this.logger}),this.roomStore=new at({instance:this.apiInstance,userStore:this.userStore,logger:this.logger}),this.cursorStore=new ct({instance:this.cursorsInstance,userStore:this.userStore,roomStore:this.roomStore,logger:this.logger}),this.typingIndicators=new lt({hooks:this.hooks,userId:this.id,instance:this.apiInstance,logger:this.logger}),this.roomSubscriptions={},this.readCursorBuffer={}}return ze(e,[{key:"rooms",get:function(){return H(this.roomStore.snapshot())}},{key:"users",get:function(){return H(this.userStore.snapshot())}}]),e}(),yt=function(){var e=this;this.setReadCursor=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.roomId,r=t.position;return Fe("roomId","number",n),Fe("position","number",r),new Promise(function(t,o){void 0!==e.readCursorBuffer[n]?(e.readCursorBuffer[n].position=v(e.readCursorBuffer[n].position,r),e.readCursorBuffer[n].callbacks.push({resolve:t,reject:o})):(e.readCursorBuffer[n]={position:r,callbacks:[{resolve:t,reject:o}]},setTimeout(function(){e.setReadCursorRequest(Be({roomId:n},e.readCursorBuffer[n])),delete e.readCursorBuffer[n]},500))})},this.readCursor=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.roomId,r=t.userId,o=void 0===r?e.id:r;if(Fe("roomId","number",n),Fe("userId","string",o),o!==e.id&&!Ie(n,e.roomSubscriptions)){var i=new TypeError("Must be subscribed to room "+n+" to access member's read cursors");throw e.logger.error(i),i}return e.cursorStore.getSync(o,n)},this.isTypingIn=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).roomId;return Fe("roomId","number",t),e.typingIndicators.sendThrottledRequest(t)},this.createRoom=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.name,r=t.addUserIds,o=qe(t,["name","addUserIds"]);return n&&Fe("name","string",n),r&&function(e,t,n){if(!Array.isArray(n))throw new TypeError("expected "+e+" to be an array");n.forEach(function(t,n){return Fe(e+"["+n+"]","string",t)})}("addUserIds",0,r),e.apiInstance.request({method:"POST",path:"/rooms",json:{created_by_id:e.id,name:n,private:!!o.private,user_ids:r}}).then(function(t){var n=Xe(JSON.parse(t));return e.roomStore.set(n.id,n)}).catch(function(t){throw e.logger.warn("error creating room:",t),t})},this.getJoinableRooms=function(){return e.apiInstance.request({method:"GET",path:"/users/"+e.encodedId+"/rooms?joinable=true"}).then(X(JSON.parse,P(Xe))).catch(function(t){throw e.logger.warn("error getting joinable rooms:",t),t})},this.joinRoom=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).roomId;return Fe("roomId","number",t),e.isMemberOf(t)?e.roomStore.get(t):e.apiInstance.request({method:"POST",path:"/users/"+e.encodedId+"/rooms/"+t+"/join"}).then(function(t){var n=Xe(JSON.parse(t));return e.roomStore.set(n.id,n)}).catch(function(n){throw e.logger.warn("error joining room "+t+":",n),n})},this.leaveRoom=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).roomId;return Fe("roomId","number",t),e.apiInstance.request({method:"POST",path:"/users/"+e.encodedId+"/rooms/"+t+"/leave"}).then(function(){return e.roomStore.pop(t)}).catch(function(n){throw e.logger.warn("error leaving room "+t+":",n),n})},this.addUserToRoom=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userId,r=t.roomId;return Fe("userId","string",n),Fe("roomId","number",r),e.apiInstance.request({method:"PUT",path:"/rooms/"+r+"/users/add",json:{user_ids:[n]}}).then(function(){return e.roomStore.addUserToRoom(r,n)}).catch(function(t){throw e.logger.warn("error adding user "+n+" to room "+r+":",t),t})},this.removeUserFromRoom=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.userId,r=t.roomId;return Fe("userId","string",n),Fe("roomId","number",r),e.apiInstance.request({method:"PUT",path:"/rooms/"+r+"/users/remove",json:{user_ids:[n]}}).then(function(){return e.roomStore.removeUserFromRoom(r,n)}).catch(function(t){throw e.logger.warn("error removing user "+n+" from room "+r+":",t),t})},this.sendMessage=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.text,r=t.roomId,o=t.attachment;return Fe("text","string",n),Fe("roomId","number",r),new Promise(function(t,n){void 0!==o&&At(o)?t(e.uploadDataAttachment(r,o)):void 0!==o&&wt(o)?t({resource_link:o.link,type:o.type}):void 0!==o?n(new TypeError("attachment was malformed")):t()}).then(function(t){return e.apiInstance.request({method:"POST",path:"/rooms/"+r+"/messages",json:{text:n,attachment:t}})}).then(X(JSON.parse,z("message_id"))).catch(function(t){throw e.logger.warn("error sending message to room "+r+":",t),t})},this.fetchMessages=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.roomId,r=t.initialId,o=t.limit,i=t.direction;return Fe("roomId","number",n),r&&Fe("initialId","number",r),o&&Fe("limit","number",o),i&&function(e,t,n){if(!pe(n,t))throw new TypeError("expected direction to be one of "+t+" but was "+n)}(0,["older","newer"],i),e.apiInstance.request({method:"GET",path:"/rooms/"+n+"/messages?"+Ge({initial_id:r,limit:o,direction:i})}).then(function(t){var n=P(K(e.decorateMessage,$e),JSON.parse(t));return e.userStore.fetchMissingUsers(Ne(P(z("senderId"),n))).then(function(){return De(function(e,t){return e.id-t.id},n)})}).catch(function(t){throw e.logger.warn("error fetching messages from room "+n+":",t),t})},this.subscribeToRoom=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.roomId,r=t.hooks,o=void 0===r?{}:r,i=t.messageLimit;return Fe("roomId","number",n),Ye("hooks","function",o),i&&Fe("messageLimit","number",i),e.roomSubscriptions[n]&&e.roomSubscriptions[n].cancel(),e.hooks.rooms[n]=o,e.roomSubscriptions[n]=new bt({messageSub:new mt({roomId:n,hooks:e.hooks,messageLimit:i,userId:e.id,instance:e.apiInstance,userStore:e.userStore,roomStore:e.roomStore,logger:e.logger}),cursorSub:new pt({onNewCursorHook:function(t){e.hooks.rooms[n]&&e.hooks.rooms[n].onNewReadCursor&&0===t.type&&t.userId!==e.id&&e.hooks.rooms[n].onNewReadCursor(t)},path:"/cursors/0/rooms/"+n,cursorStore:e.cursorStore,instance:e.cursorsInstance,logger:e.logger,connectionTimeout:e.connectionTimeout})}),e.joinRoom({roomId:n}).then(function(t){return Promise.all([e.roomSubscriptions[n].messageSub.connect(),e.roomSubscriptions[n].cursorSub.connect()]).then(function(){return t})}).catch(function(t){throw e.logger.warn("error subscribing to room "+n+":",t),t})},this.fetchAttachment=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).url;return e.filesInstance.tokenProvider.fetchToken().then(function(e){return a({method:"GET",headers:{Authorization:"Bearer "+e},url:t})}).then(X(JSON.parse,et)).catch(function(t){throw e.logger.warn("error fetching attachment:",t),t})},this.updateRoom=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.roomId,r=t.name,o=qe(t,["roomId","name"]);return Fe("roomId","number",n),r&&Fe("name","string",r),o.private&&Fe("private","boolean",o.private),e.apiInstance.request({method:"PUT",path:"/rooms/"+n,json:{name:r,private:o.private}}).then(function(){}).catch(function(t){throw e.logger.warn("error updating room:",t),t})},this.deleteRoom=function(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).roomId;return Fe("roomId","number",t),e.apiInstance.request({method:"DELETE",path:"/rooms/"+t}).then(function(){}).catch(function(t){throw e.logger.warn("error deleting room:",t),t})},this.setReadCursorRequest=function(t){var n=t.roomId,r=t.position,o=t.callbacks;return e.cursorsInstance.request({method:"PUT",path:"/cursors/0/rooms/"+n+"/users/"+e.encodedId,json:{position:r}}).then(function(){return P(function(e){return e.resolve()},o)}).catch(function(t){e.logger.warn("error setting cursor:",t),P(function(e){return e.reject(t)},o)})},this.uploadDataAttachment=function(t,n){var r=n.file,o=n.name,i=new FormData;return i.append("file",r,o),e.filesInstance.request({method:"POST",path:"/rooms/"+t+"/users/"+e.encodedId+"/files/"+o,body:i}).then(JSON.parse)},this.isMemberOf=function(t){return pe(t,P(z("id"),e.rooms))},this.decorateMessage=function(t){return new gt(t,e.userStore,e.roomStore)},this.establishUserSubscription=function(){return e.userSubscription=new ht({hooks:e.hooks,userId:e.id,instance:e.apiInstance,userStore:e.userStore,roomStore:e.roomStore,typingIndicators:e.typingIndicators,logger:e.logger,connectionTimeout:e.connectionTimeout}),e.userSubscription.connect().then(function(t){var n=t.user,r=t.basicRooms;e.avatarURL=n.avatarURL,e.createdAt=n.createdAt,e.customData=n.customData,e.name=n.name,e.updatedAt=n.updatedAt,e.roomStore.initialize(xe(z("id"),r))}).then(e.initializeUserStore).catch(function(t){throw e.logger.error("error establishing user subscription:",t),t})},this.establishPresenceSubscription=function(){return e.presenceSubscription=new dt({hooks:e.hooks,userId:e.id,instance:e.presenceInstance,userStore:e.userStore,roomStore:e.roomStore,presenceStore:e.presenceStore,logger:e.logger,connectionTimeout:e.connectionTimeout}),e.presenceSubscription.connect().catch(function(t){throw e.logger.error("error establishing presence subscription:",t),t})},this.establishCursorSubscription=function(){return e.cursorSubscription=new pt({onNewCursorHook:function(t){e.hooks.global.onNewReadCursor&&0===t.type&&e.isMemberOf(t.roomId)&&e.hooks.global.onNewReadCursor(t)},path:"/cursors/0/users/"+e.encodedId,cursorStore:e.cursorStore,instance:e.cursorsInstance,logger:e.logger,connectionTimeout:e.connectionTimeout}),e.cursorSubscription.connect().then(function(){return e.cursorStore.initialize({})}).catch(function(t){throw e.logger.error("error establishing cursor subscription:",t),t})},this.initializeUserStore=function(){return e.userStore.fetchMissingUsers(Ne(Q(z("userIds"),e.rooms))).catch(function(t){e.logger.warn("error fetching initial user information:",t)}).then(function(){return e.userStore.initialize({})})},this.disconnect=function(){e.userSubscription.cancel(),e.presenceSubscription.cancel(),e.cursorSubscription.cancel(),we(function(e){return e.cancel()},e.roomSubscriptions)}},At=function(e){var t=e.file,n=e.name;return void 0!==t&&void 0!==n&&(Fe("attachment.file","object",t),Fe("attachment.name","string",n),!0)},wt=function(e){var t=e.link,n=e.type;return void 0!==t&&void 0!==n&&(Fe("attachment.link","string",t),Fe("attachment.type","string",n),!0)};return{TokenProvider:function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.url,o=n.queryParams,i=n.headers;Ue(this,e),this.fetchToken=function(){return t.cacheIsStale()?(t.req||t.fetchFreshToken()).then(function(e){var n=e.token,r=e.expiresIn;return t.cache(n,r),n}):Promise.resolve(t.cachedToken)},this.fetchFreshToken=function(){return t.req=a({method:"POST",url:Qe(Be({user_id:t.userId},t.queryParams),t.url),body:Ge({grant_type:"client_credentials"}),headers:Be({"content-type":"application/x-www-form-urlencoded"},t.headers)}).then(function(e){var n=JSON.parse(e),r=n.access_token,o=n.expires_in;return delete t.req,{token:r,expiresIn:o}}).catch(function(e){throw delete t.req,e}),t.req},this.cacheIsStale=function(){return!t.cachedToken||Je()>t.cacheExpiresAt},this.cache=function(e,n){t.cachedToken=e,t.cacheExpiresAt=Je()+n},this.clearCache=function(){t.cachedToken=void 0,t.cacheExpiresAt=void 0},this.setUserId=function(e){t.clearCache(),t.userId=e},Fe("url","string",r),o&&Fe("queryParams","object",o),i&&Fe("headers","object",i),this.url=r,this.queryParams=o,this.headers=i},ChatManager:function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=n.instanceLocator,a=n.tokenProvider,u=n.userId,c=qe(n,["instanceLocator","tokenProvider","userId"]);Ue(this,e),this.connect=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Ye("hooks","function",e);var n=new vt({hooks:e,id:t.userId,apiInstance:t.apiInstance,filesInstance:t.filesInstance,cursorsInstance:t.cursorsInstance,presenceInstance:t.presenceInstance,connectionTimeout:t.connectionTimeout});return Promise.all([n.establishUserSubscription(),n.establishPresenceSubscription(),n.establishCursorSubscription()]).then(function(){return t.currentUser=n,n})},this.disconnect=function(){t.currentUser&&t.currentUser.disconnect()},Fe("instanceLocator","string",r),Fe("tokenProvider","object",a),Fe("tokenProvider.fetchToken","function",a.fetchToken),Fe("userId","string",u);var f=Le(":",r)[1];if(void 0===f)throw new TypeError("expected instanceLocator to be of the format x:y:z, but was "+r);var l=c.baseClient||new o({host:f+"."+i,logger:c.logger,sdkProduct:"chatkit",sdkVersion:"0.7.15"});"function"==typeof a.setUserId&&a.setUserId(u);var h={client:l,locator:r,logger:c.logger,tokenProvider:a};this.apiInstance=new s(Be({serviceName:"chatkit",serviceVersion:"v1"},h)),this.filesInstance=new s(Be({serviceName:"chatkit_files",serviceVersion:"v1"},h)),this.cursorsInstance=new s(Be({serviceName:"chatkit_cursors",serviceVersion:"v1"},h)),this.presenceInstance=new s(Be({serviceName:"chatkit_presence",serviceVersion:"v1"},h)),this.userId=u,this.connectionTimeout=c.connectionTimeout||1e4}}}()}).call(this,n(4))},function(e,t,n){"use strict";function r(e){this.message=e}r.prototype.toString=function(){return"Cancel"+(this.message?": "+this.message:"")},r.prototype.__CANCEL__=!0,e.exports=r},function(e,t,n){"use strict";e.exports=function(e){return!(!e||!e.__CANCEL__)}},function(e,t,n){"use strict";var r=n(35);e.exports=function(e,t,n,o,i){var s=new Error(e);return r(s,t,n,o,i)}},function(e,t,n){"use strict";var r=n(1),o=n(36),i=n(34),s=n(33),a=n(32),u=n(10),c="undefined"!=typeof window&&window.btoa&&window.btoa.bind(window)||n(31);e.exports=function(e){return new Promise(function(t,f){var l=e.data,h=e.headers;r.isFormData(l)&&delete h["Content-Type"];var d=new XMLHttpRequest,p="onreadystatechange",g=!1;if("undefined"==typeof window||!window.XDomainRequest||"withCredentials"in d||a(e.url)||(d=new window.XDomainRequest,p="onload",g=!0,d.onprogress=function(){},d.ontimeout=function(){}),e.auth){var m=e.auth.username||"",b=e.auth.password||"";h.Authorization="Basic "+c(m+":"+b)}if(d.open(e.method.toUpperCase(),i(e.url,e.params,e.paramsSerializer),!0),d.timeout=e.timeout,d[p]=function(){if(d&&(4===d.readyState||g)&&(0!==d.status||d.responseURL&&0===d.responseURL.indexOf("file:"))){var n="getAllResponseHeaders"in d?s(d.getAllResponseHeaders()):null,r={data:e.responseType&&"text"!==e.responseType?d.response:d.responseText,status:1223===d.status?204:d.status,statusText:1223===d.status?"No Content":d.statusText,headers:n,config:e,request:d};o(t,f,r),d=null}},d.onerror=function(){f(u("Network Error",e,null,d)),d=null},d.ontimeout=function(){f(u("timeout of "+e.timeout+"ms exceeded",e,"ECONNABORTED",d)),d=null},r.isStandardBrowserEnv()){var v=n(30),y=(e.withCredentials||a(e.url))&&e.xsrfCookieName?v.read(e.xsrfCookieName):void 0;y&&(h[e.xsrfHeaderName]=y)}if("setRequestHeader"in d&&r.forEach(h,function(e,t){void 0===l&&"content-type"===t.toLowerCase()?delete h[t]:d.setRequestHeader(t,e)}),e.withCredentials&&(d.withCredentials=!0),e.responseType)try{d.responseType=e.responseType}catch(t){if("json"!==e.responseType)throw t}"function"==typeof e.onDownloadProgress&&d.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&d.upload&&d.upload.addEventListener("progress",e.onUploadProgress),e.cancelToken&&e.cancelToken.promise.then(function(e){d&&(d.abort(),f(e),d=null)}),void 0===l&&(l=null),d.send(l)})}},function(e,t,n){"use strict";e.exports=function(e,t){return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];return e.apply(t,n)}}},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(e){if(n===setTimeout)return setTimeout(e,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var u,c=[],f=!1,l=-1;function h(){f&&u&&(f=!1,u.length?c=u.concat(c):l=-1,c.length&&d())}function d(){if(!f){var e=a(h);f=!0;for(var t=c.length;t;){for(u=c,c=[];++l<t;)u&&u[l].run();l=-1,t=c.length}u=null,f=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function g(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new p(e,t)),1!==c.length||f||a(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=g,o.addListener=g,o.once=g,o.off=g,o.removeListener=g,o.removeAllListeners=g,o.emit=g,o.prependListener=g,o.prependOnceListener=g,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){e.exports="data:audio/mpeg;base64,//uUZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWGluZwAAAA8AAAALAAAHyAAPDw8PDw8PDw8eHh4eHh4eHh45OTk5OTk5OTlnZ2dnZ2dnZ2eNjY2NjY2NjY2zs7Ozs7Ozs7PCwsLCwsLCwsLS0tLS0tLS0tLh4eHh4eHh4eHw8PDw8PDw8PD///////////8AAAA8TEFNRTMuOThyBK8AAAAAAAAAADQgJAXAjQABzAAAB8jbBDi/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//sUZAAP8AAAaQAAAAgAAA0gAAABAAAB/gAAACAAADSAAAAEAYFAwFAoHA4GAAAAAA9CereO6lvfzP5Mp+Zn4BQKBRuXVKoy4nHHMr1pN1NqKDT8MyUpOUZWTuGeuzm5//sUZB4P8AAAf4AAAAgAAA0gAAABAAAB/hQAACAAADSCgAAEmZls8fWSQ9Oo8FmzbhxBO8sDgJBvDCnOAJdj7ST3QWI0FNIlBvRiSwjKIIptYhp+6tPD9DDix2d0bO5///tEZDwAANoI5+4IAHAAAA0gwAAAG517S7m8ogAAADSDAAAAsNNKfW3hF4nF5W5cjgR037dx9Jh0WmvtEZfSZ5br34y/bLIp7+Ujs3puUzuOsNfSWsM/lkuaxAj8V+xubaVI4ZfG/WpcPz/P+fvVPh3faent0b6QNL60poLtyehqe/99/+d/+f8CMspZ+k53eNvDXGQxlxakO1s6WN2NzLX///QqZ3MQ//t0ZAGA9Fxe0/9tAAoAAA0g4AABDZkTRe2kbWAAADSAAAAEAjCStdZfjDhUs6GCoQOr7BwcBAEIAU1BGAmIEppnqaUDJitNisqlwqK1yHI4PRIaDYG18kipoeqv/rDXStw7cZTMKjFB4eazRbILWzLHBRI55NhmNFhXVmlbWmlVXlYOmGsVJQ6Drk2F1SaOJFWjaaUk1rh+6yQexZhYVh7mQ5XXj////i75JlhnAgADOLv9tqBJWIQot+EGSfhgIWnKjikS3NDIySfPGBSgRe8cbUUXlOjolFkKayKdsw6E2ijXrMsFPVvRLk9j0nMw049dXbSC0RljXykmZMpq4xs5t8j04RiVVzdUkh352jKGDoGeqGCIi4Sq/7QDs03///tkZAMA8zZK0WsaGqoAAA0gAAABC9jdP6wYbOgAADSAAAAE93AQ59Ao4NnDgqVaCUDzMHTSMnzrE2mS+MU85GMuMZlayG3UWCnKhiOZKDZyYrn6E+pgxPHjAdj5hIVNgRFaFlqxG55KXdoxn6anwKbnm2KYmM10czqP1QnQ5KE8ZAMS9n9AE0s19tsDNXpEjGpyMQQQt9g5DC06SRgK+/WYQJTGFp01aeZdaoJZQQq9DVQRdXmaWlEDgdQrDY1cyzz/yiBCkPXNsyyivSQObQRLtQBjqXXwzMRLEXqdd9LJjnj6WGIAB1Vpv7ZIFRrD//tkZAYA80NOT/smG9gAAA0gAAABCr0XOeewaqAAADSAAAAEAAwHCrUAxbY092RNWWEMOYIinsX/iFws84vealMympIuDVinrJneebe/Xk1di2DnECszZtlx4CXxWGlaGwLM9wVwVTc9VkWEnC/ekVI5mXnzlJImRZ+ZqZYJBWKk7MYC0M3/29sGVC4gygEYBKBBE/MA4WUKkIL4dlm0F3fgqxYseo25a0mFU+Nrr1SL1Vaokmb2VVX+SkzGSl3X4d7Gb//yjfw6q//PlLtUKtQ7lYlDWioFOxQW4cAAAITKUsUdxJQPQg1c8yy3g0HX//sUZAyH8OMHymgvYRgAAA0gAAABAJgBW8AAACAAADSAAAAEfSWiwAAB/xJVTEFNRTMuOTguNFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sUZBmP8AAAf4AAAAgAAA0gAAABAAAB/gAAACAAADSAAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sUZDeP8AAAf4AAAAgAAA0gAAABAAAB/gAAACAAADSAAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sUZFWP8AAAf4AAAAgAAA0gAAABAAABpAAAACAAADSAAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV//sUZHOP8AAAaQAAAAgAAA0gAAABAAABpAAAACAAADSAAAAEVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV"},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1OCA1OCI+PHBhdGggZD0iTTI1IDkuNTg2QzExLjE5MyA5LjU4NiAwIDE5LjYyMSAwIDMyYzAgNC41NjIgMS41MjQgOC44MDMgNC4xMzUgMTIuMzQzQzMuNzkyIDQ4LjQzMyAyLjgwNSA1NC4xOTQgMCA1N2MwIDAgOC41NzEtMS4yMDMgMTQuMzc3LTQuNzA5QTI3LjMyOSAyNy4zMjkgMCAwIDAgMjUgNTQuNDE0YzEzLjgwNyAwIDI1LTEwLjAzNSAyNS0yMi40MTRTMzguODA3IDkuNTg2IDI1IDkuNTg2eiIgZmlsbD0iIzUxYTBkZCIvPjxwYXRoIGQ9Ik01OCAyMy40MTRDNTggMTEuMDM1IDQ2LjgwNyAxIDMzIDFjLTkuOTcgMC0xOC41NzUgNS4yMzQtMjIuNTg5IDEyLjgwNEMxNC41MTggMTEuMTUzIDE5LjU1MyA5LjU4NiAyNSA5LjU4NmMxMy44MDcgMCAyNSAxMC4wMzUgMjUgMjIuNDE0IDAgNC43MzUtMS42NDIgOS4xMjQtNC40MzcgMTIuNzQzQzUxLjE2MiA0Ny40NDggNTggNDguNDE0IDU4IDQ4LjQxNGMtMi44MDUtMi44MDUtMy43OTItOC41NjYtNC4xMzUtMTIuNjU3QzU2LjQ3NiAzMi4yMTcgNTggMjcuOTc2IDU4IDIzLjQxNHoiIGZpbGw9IiMyMjZiYWMiLz48Y2lyY2xlIGN4PSIxMiIgY3k9IjMyIiByPSIzIiBmaWxsPSIjZmZmIi8+PGNpcmNsZSBjeD0iMjUiIGN5PSIzMiIgcj0iMyIgZmlsbD0iI2ZmZiIvPjxjaXJjbGUgY3g9IjM4IiBjeT0iMzIiIHI9IjMiIGZpbGw9IiNmZmYiLz48L3N2Zz4="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxNiAxOCI+PHBhdGggZD0iTTE0LjE1NCA2LjkxOGwtLjAwNC4wMDMuMDAxLS4wMDQtMy4yODcgMy4yODYtLjAwNi0uMDA1LTMuNTc0IDMuNTc0Yy0uMDE2LjAxNy0uMDMuMDM2LS4wNDguMDUzbC0uMDUuMDQ3LS4wNDMuMDQxdi0uMDAyYy0xLjE2NyAxLjA3LTIuNjkyIDEuMzMxLTMuODIzLjItMS4xMy0xLjEzLS44OS0yLjY3Ny4xOC0zLjg0M2wtLjAwNS0uMDA0LjA3NC0uMDczLjAxNi0uMDE4Yy4wMDYtLjAwNS4wMTItLjAwOS4wMTctLjAxNmw2LjA1My02LjA1My43NjEuNzYtNi4wNTMgNi4wNTQtLjAyOS4wMjh2LjAwMWwtLjAwNS4wMDQtLjA3My4wNzRjLjAxMS0uMDEuMDI1LS4wMTguMDM1LS4wMy0uNjg4Ljc1LS45MyAxLjYzNi0uMjEgMi4zNTYuNzIuNzIgMS41ODMuNDU2IDIuMzMzLS4yMzJsLS4wMy4wMzQuMDQtLjA0Mi4wMS0uMDA4LjAwOC0uMDA5LjAzMy0uMDMuMDMxLS4wMzQuMDEtLjAwOS4wMDctLjAwOSA1LjAwNC01LjAwMy4wMDUuMDA2IDEuODU4LTEuODU5YzEuMjIzLTEuMjE4IDEuNTEtMi45MTMuMjkxLTQuMTMyQzEyLjQ2Mi44MDYgMTAuNDE0Ljc0IDkuMTk1IDEuOTU4TDIuMjQ4IDguOTA1Yy4wMDMgMCAuMDA2LS4wMDIuMDA4LS4wMDQtMS42MjUgMS42NjctMS41NDIgNC40My4xMDMgNi4wNzQgMS42NDYgMS42NDYgNC40NzQgMS43OTUgNi4xNDEuMTctLjAwMy4wMDItLjAwNC4wMDgtLjAwOC4wMTJsLjA0Ny0uMDQ3IDYuMDUzLTYuMDU0LjA0Mi0uMDQyLjc0My43OC0uMDI1LjAyMS4wMDEuMDAyLTYuMDUgNi4wNS0uMDAyLjAwMi0uMDAyLjAwMS0uMDQ2LjA0NmgtLjAwMmMtMi4wOTQgMi4wNC01LjU3OCAxLjg5NC03LjY1Mi0uMTgtMi4wNDktMi4wNDktMi4xNS01LjQwNy0uMTgzLTcuNTA1bC0uMDA2LS4wMDVoLS4wMDJsLjA3Ni0uMDc4IDYuOTQzLTYuOTQ0LjAwMy0uMDAyLjAwNC0uMDA1YzEuNjQxLTEuNjQgNC4zNjctMS41NzQgNi4wMDguMDY2IDEuNjQgMS42NDIgMS4zNTMgNC4wMTQtLjI4OCA1LjY1NXoiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPg=="},function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA0OTAuMjgyIDQ5MC4yODIiPjxwYXRoIGQ9Ik0uMDQzIDI0NS4xOTdjLjYgMTAuMSA3LjMgMTguNiAxNyAyMS41bDE3OS42IDU0LjMgNi42IDEyMy44Yy4zIDQuOSAzLjYgOS4yIDguMyAxMC44IDEuMy41IDIuNy43IDQgLjcgMy41IDAgNi44LTEuNCA5LjItNC4xbDYzLjUtNzAuMyA5MCA2Mi4zYzQgMi44IDguNyA0LjMgMTMuNiA0LjMgMTEuMyAwIDIxLjEtOCAyMy41LTE5LjJsNzQuNy0zODAuN2MuOS00LjQtLjgtOS00LjItMTEuOC0zLjUtMi45LTguMi0zLjYtMTIuNC0xLjlsLTQ1OSAxODYuOGMtOS4zIDQuMi0xNSAxMy40LTE0LjQgMjMuNXptMjI2IDE2OC45bC00LjEtNzguMSA0NiAzMS44LTQxLjkgNDYuM3ptMTY1LjQgOS41bC0xNjMuOC0xMTMuNCAyMjkuNy0yMjIuMi02NS45IDMzNS42em00MC43LTM0NS40bC0yMjcuMSAyMTkuNy0xNzkuNC01NC4yIDQwNi41LTE2NS41eiIvPjwvc3ZnPg=="},function(e,t){e.exports=function(e){var t="undefined"!=typeof window&&window.location;if(!t)throw new Error("fixUrls requires window.location");if(!e||"string"!=typeof e)return e;var n=t.protocol+"//"+t.host,r=n+t.pathname.replace(/\/[^\/]*$/,"/");return e.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(e,t){var o,i=t.trim().replace(/^"(.*)"$/,function(e,t){return t}).replace(/^'(.*)'$/,function(e,t){return t});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/|\s*$)/i.test(i)?e:(o=0===i.indexOf("//")?i:0===i.indexOf("/")?n+i:r+i.replace(/^\.\//,""),"url("+JSON.stringify(o)+")")})}},function(e,t,n){var r={},o=function(e){var t;return function(){return void 0===t&&(t=e.apply(this,arguments)),t}}(function(){return window&&document&&document.all&&!window.atob}),i=function(e){var t={};return function(e){if("function"==typeof e)return e();if(void 0===t[e]){var n=function(e){return document.querySelector(e)}.call(this,e);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(e){n=null}t[e]=n}return t[e]}}(),s=null,a=0,u=[],c=n(18);function f(e,t){for(var n=0;n<e.length;n++){var o=e[n],i=r[o.id];if(i){i.refs++;for(var s=0;s<i.parts.length;s++)i.parts[s](o.parts[s]);for(;s<o.parts.length;s++)i.parts.push(m(o.parts[s],t))}else{var a=[];for(s=0;s<o.parts.length;s++)a.push(m(o.parts[s],t));r[o.id]={id:o.id,refs:1,parts:a}}}}function l(e,t){for(var n=[],r={},o=0;o<e.length;o++){var i=e[o],s=t.base?i[0]+t.base:i[0],a={css:i[1],media:i[2],sourceMap:i[3]};r[s]?r[s].parts.push(a):n.push(r[s]={id:s,parts:[a]})}return n}function h(e,t){var n=i(e.insertInto);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var r=u[u.length-1];if("top"===e.insertAt)r?r.nextSibling?n.insertBefore(t,r.nextSibling):n.appendChild(t):n.insertBefore(t,n.firstChild),u.push(t);else if("bottom"===e.insertAt)n.appendChild(t);else{if("object"!=typeof e.insertAt||!e.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var o=i(e.insertInto+" "+e.insertAt.before);n.insertBefore(t,o)}}function d(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e);var t=u.indexOf(e);t>=0&&u.splice(t,1)}function p(e){var t=document.createElement("style");return void 0===e.attrs.type&&(e.attrs.type="text/css"),g(t,e.attrs),h(e,t),t}function g(e,t){Object.keys(t).forEach(function(n){e.setAttribute(n,t[n])})}function m(e,t){var n,r,o,i;if(t.transform&&e.css){if(!(i=t.transform(e.css)))return function(){};e.css=i}if(t.singleton){var u=a++;n=s||(s=p(t)),r=v.bind(null,n,u,!1),o=v.bind(null,n,u,!0)}else e.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=function(e){var t=document.createElement("link");return void 0===e.attrs.type&&(e.attrs.type="text/css"),e.attrs.rel="stylesheet",g(t,e.attrs),h(e,t),t}(t),r=function(e,t,n){var r=n.css,o=n.sourceMap,i=void 0===t.convertToAbsoluteUrls&&o;(t.convertToAbsoluteUrls||i)&&(r=c(r));o&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(o))))+" */");var s=new Blob([r],{type:"text/css"}),a=e.href;e.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}.bind(null,n,t),o=function(){d(n),n.href&&URL.revokeObjectURL(n.href)}):(n=p(t),r=function(e,t){var n=t.css,r=t.media;r&&e.setAttribute("media",r);if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}.bind(null,n),o=function(){d(n)});return r(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;r(e=t)}else o()}}e.exports=function(e,t){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(t=t||{}).attrs="object"==typeof t.attrs?t.attrs:{},t.singleton||"boolean"==typeof t.singleton||(t.singleton=o()),t.insertInto||(t.insertInto="head"),t.insertAt||(t.insertAt="bottom");var n=l(e,t);return f(n,t),function(e){for(var o=[],i=0;i<n.length;i++){var s=n[i];(a=r[s.id]).refs--,o.push(a)}e&&f(l(e,t),t);for(i=0;i<o.length;i++){var a;if(0===(a=o[i]).refs){for(var u=0;u<a.parts.length;u++)a.parts[u]();delete r[a.id]}}}};var b=function(){var e=[];return function(t,n){return e[t]=n,e.filter(Boolean).join("\n")}}();function v(e,t,n,r){var o=n?"":r.css;if(e.styleSheet)e.styleSheet.cssText=b(t,o);else{var i=document.createTextNode(o),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(i,s[t]):e.appendChild(i)}}},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",r=e[3];if(!r)return n;if(t&&"function"==typeof btoa){var o=function(e){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(e))))+" */"}(r),i=r.sources.map(function(e){return"/*# sourceURL="+r.sourceRoot+e+" */"});return[n].concat(i).concat([o]).join("\n")}return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<e.length;o++){var s=e[o];"number"==typeof s[0]&&r[s[0]]||(n&&!s[2]?s[2]=n:n&&(s[2]="("+s[2]+") and ("+n+")"),t.push(s))}},t}},function(e,t,n){(e.exports=n(20)(!1)).push([e.i,'* {\n  box-sizing: border-box;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale; }\n\nbody {\n  height: 100vh;\n  font-family: sans-serif;\n  background: #f0f0f0; }\n\n@keyframes moveUpVisible {\n  from {\n    bottom: 0px;\n    opacity: 0; }\n  to {\n    bottom: 48px;\n    opacity: 1; } }\n\nsf-chat.bottom {\n  bottom: 48px;\n  animation-name: moveUpVisible; }\n  @media (max-width: 600px) {\n    sf-chat.bottom {\n      bottom: 0; } }\n\nsf-chat.top {\n  top: 48px; }\n\nsf-chat.left {\n  left: 48px; }\n  @media (max-width: 600px) {\n    sf-chat.left {\n      left: 0; } }\n\nsf-chat.right {\n  right: 48px; }\n\nsf-chat.active {\n  opacity: 1; }\n\n.sf-chat-launcher {\n  z-index: 99999999999;\n  width: 48px;\n  height: 48px;\n  display: block;\n  background-color: #16a085;\n  position: fixed;\n  outline: none;\n  box-shadow: 0 0 30px rgba(100, 100, 100, 0.2); }\n\n.sf-chat-launcher:hover {\n  cursor: pointer; }\n\n@keyframes moveUpVisible {\n  from {\n    bottom: 0px;\n    opacity: 0; }\n  to {\n    bottom: 48px;\n    opacity: 1; } }\n\n.sf-chat-launcher.bottom.left {\n  bottom: 0px;\n  left: 0px;\n  border-top-right-radius: 50%; }\n\n.sf-chat-launcher.top.left {\n  left: 0px;\n  top: 0px;\n  border-bottom-right-radius: 50%; }\n\n.sf-chat-launcher.top.right {\n  right: 0px;\n  border-bottom-left-radius: 50%; }\n\n.sf-chat-launcher.top.right {\n  top: 0px;\n  right: 0px;\n  border-bottom-left-radius: 50%; }\n\n.sf-chat-launcher.bottom.right {\n  right: 0px;\n  bottom: 0px;\n  border-top-left-radius: 50%; }\n\n.sf-chat-launcher__chat {\n  width: 24px;\n  height: 24px;\n  display: block;\n  margin-top: 12px;\n  margin: 12px auto 0; }\n\n.sf-chat-launcher__close {\n  width: 20px;\n  height: 20px;\n  display: block;\n  margin: 16px auto;\n  padding-right: 2px; }\n\nsf-chat {\n  position: relative;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-direction: column;\n  flex-direction: column;\n  margin: auto;\n  width: 23rem;\n  height: 38rem;\n  background: #fff;\n  animation: fadeInUp 1s;\n  border-radius: 16px;\n  font-family: Roboto,Helvetica Neue,sans-serif;\n  z-index: 99999999999;\n  left: initial;\n  bottom: initial;\n  position: fixed;\n  box-shadow: 0 10px 20px rgba(0, 0, 0, 0.19), 0 6px 6px rgba(100, 100, 100, 0.23);\n  background-color: #fff;\n  box-sizing: border-box;\n  animation-duration: .25s; }\n  @media (max-width: 600px) {\n    sf-chat {\n      width: 100%;\n      height: 100%; } }\n\nsf-chat-header {\n  box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.12);\n  overflow: hidden;\n  width: 100%;\n  background: linear-gradient(to right, #26a69a, #1d7d74);\n  border-radius: 16px 16px 0 0;\n  border-bottom: 1px solid #e0e0e0;\n  z-index: 1;\n  -ms-flex: none;\n  flex: none;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-align: center;\n  align-items: center;\n  height: 3.8rem; }\n  sf-chat-header img {\n    width: 1.5rem;\n    height: 1.5rem;\n    border-radius: 50%; }\n  sf-chat-header p {\n    padding: 24px;\n    text-align: left;\n    font-weight: 400;\n    letter-spacing: .2px;\n    width: calc(100% - 24px);\n    float: left;\n    white-space: nowrap;\n    line-height: 1.1em;\n    color: #fff;\n    box-sizing: border-box;\n    white-space: normal;\n    color: rgba(255, 255, 255, 0.9); }\n\n.sf-chat-header__close {\n  cursor: pointer;\n  position: absolute;\n  right: 16px;\n  top: 20px;\n  width: 20px;\n  height: 20px; }\n  @media (max-width: 600px) {\n    .sf-chat-header__close {\n      display: block; } }\n\n.sf-chat__body {\n  -ms-flex: 1 1 100%;\n  flex: 1 1 100%;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-direction: column;\n  flex-direction: column;\n  padding: 1rem;\n  overflow: auto; }\n\n.sf-chat__container {\n  position: relative;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex-direction: column;\n  flex-direction: column;\n  margin: auto;\n  width: 100%;\n  height: 100%;\n  background: #fff;\n  overflow: hidden; }\n  @media (min-width: 600px) {\n    .sf-chat__container {\n      height: 34rem; } }\n\n.sf-chat__footer {\n  position: relative;\n  border-top: 1px solid #e0e0e0;\n  border-bottom-right-radius: 16px;\n  border-bottom-left-radius: 16px;\n  overflow: hidden; }\n\n.sf-chat__message-wrap {\n  background: #f0f0f0;\n  max-width: 100%;\n  word-break: break-all;\n  border-radius: 0 0.5rem 0.5rem 0.5rem;\n  margin-bottom: 4px; }\n\nsf-chat-message {\n  display: block;\n  font-size: 100%;\n  font-style: normal;\n  letter-spacing: normal;\n  font-stretch: normal;\n  font-variant: normal;\n  font-weight: 400;\n  font: normal normal 100% "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif;\n  text-align-last: auto;\n  text-decoration: none;\n  -webkit-text-emphasis: none;\n  text-shadow: none;\n  text-transform: none;\n  baseline-shift: baseline;\n  padding-left: 32px;\n  position: relative;\n  display: -ms-flexbox;\n  display: flex;\n  -ms-flex: none;\n  flex: none;\n  -ms-flex-align: end;\n  align-items: flex-end; }\n  sf-chat-message p {\n    color: rgba(0, 0, 0, 0.8); }\n\nsf-chat-message.active-user .sf-chat__message-wrap {\n  background-color: #26a69a;\n  color: #fff;\n  margin-bottom: 4px;\n  border-radius: 0.5rem 0.5rem 0 0.5rem; }\n\nsf-chat-message.active-user, sf-chat-message.active-user .sf-chat__message-wrap, sf-chat-message.active-user .sf-chat__message-text {\n  -ms-flex-direction: row-reverse;\n  flex-direction: row-reverse; }\n  sf-chat-message.active-user p, sf-chat-message.active-user .sf-chat__message-wrap p, sf-chat-message.active-user .sf-chat__message-text p {\n    color: #fff; }\n\nsf-chat-message[deleted], sf-chat .sf-chat__body sf-chat-message[deleted] {\n  display: none; }\n\nsf-chat-message.active-user .sf-chat__username {\n  display: none; }\n\nsf-chat-message .sf-chat__username, sf-chat-message.active-user[block] .sf-chat__username {\n  display: none; }\n\nsf-chat-message[block] {\n  margin-top: 16px; }\n  sf-chat-message[block] .sf-chat__user-avatar {\n    display: block; }\n  sf-chat-message[block] .sf-chat__username {\n    display: block;\n    width: auto;\n    font-weight: 500;\n    margin-bottom: 8px;\n    padding: 8px 16px 0px 12px; }\n\n.sf-chat__user-avatar {\n  display: none; }\n  .sf-chat__user-avatar img {\n    display: inline-block;\n    border-radius: 50%;\n    overflow: hidden;\n    text-align: center;\n    max-width: 40px;\n    max-height: 40px;\n    position: absolute;\n    left: 0;\n    top: 0; }\n\n.sf-chat__message-text {\n  margin-right: 0;\n  width: auto;\n  padding: 4px 12px;\n  display: inline-block; }\n\n.sf-chat__message-text p {\n  font-size: 14px;\n  line-height: 1.3;\n  overflow-wrap: break-word;\n  word-wrap: break-word;\n  word-break: break-all; }\n\n.sf-chat__username + .sf-chat__attachment {\n  top: 48px; }\n\n.sf-chat__attachment + .sf-chat__message-text {\n  padding-left: 80px; }\n\n.sf-chat__attachment {\n  cursor: pointer;\n  overflow: hidden;\n  position: absolute;\n  left: 40px;\n  top: 16px; }\n\n.sf-chat__message-unfurl {\n  position: relative;\n  padding-left: 44px;\n  margin-bottom: 8px; }\n\n.sf-chat__message-unfurl-img {\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  width: 36px;\n  height: 36px; }\n\n.sf-chat__message-unfurl-url {\n  font-size: 14px;\n  text-decoration: none;\n  color: #00766c; }\n\n.sf-chat__message-unfurl-title {\n  font-size: 12px;\n  max-width: 220px;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n  display: block; }\n\n.sf-chat__attachment-preview {\n  max-width: 64px;\n  max-height: 48px;\n  overflow: hidden;\n  display: block; }\n\n.sf-chat__attachment-size, .sf-chat__attachment-ext {\n  font-size: 10px; }\n\n.sf-chat__form-input form, .sf-chat__form-uploader form {\n  -ms-flex: none;\n  flex: none;\n  -ms-flex-align: center;\n  align-items: center;\n  height: 64px;\n  display: -ms-flexbox;\n  display: flex;\n  width: 100%; }\n  .sf-chat__form-input form input, .sf-chat__form-input form textarea, .sf-chat__form-uploader form input, .sf-chat__form-uploader form textarea {\n    font-family: Roboto,Helvetica Neue,sans-serif;\n    -ms-flex: 1 1 100%;\n    flex: 1 1 100%;\n    padding-left: 24px;\n    padding-top: 8px;\n    border: 0;\n    line-height: 1.2rem;\n    font-weight: 400;\n    font-size: 14px;\n    white-space: pre-wrap;\n    word-wrap: break-word;\n    resize: none;\n    border: none;\n    padding-right: 40px;\n    overflow: hidden; }\n    .sf-chat__form-input form input:focus, .sf-chat__form-input form textarea:focus, .sf-chat__form-uploader form input:focus, .sf-chat__form-uploader form textarea:focus {\n      outline: none; }\n  .sf-chat__form-input form label, .sf-chat__form-input form .sf-chat__form-uploader-btn, .sf-chat__form-uploader form label, .sf-chat__form-uploader form .sf-chat__form-uploader-btn {\n    cursor: pointer; }\n  .sf-chat__form-input form input#roomname, .sf-chat__form-input form input#username, .sf-chat__form-uploader form input#roomname, .sf-chat__form-uploader form input#username {\n    visibility: hidden;\n    position: absolute; }\n  .sf-chat__form-input form button, .sf-chat__form-uploader form button {\n    cursor: pointer;\n    bottom: 16px;\n    right: 0;\n    position: absolute;\n    border: 0;\n    padding: 0 1rem;\n    background: #fff; }\n    .sf-chat__form-input form button svg, .sf-chat__form-uploader form button svg {\n      width: 1.5rem;\n      height: 1.5rem;\n      fill: #006eff; }\n\n.sf-chat__form-uploader {\n  position: absolute;\n  bottom: 0px;\n  right: 16px;\n  height: 58px; }\n\n.sf-chat__form-loader-icon {\n  margin-top: 16px;\n  height: 24px;\n  width: 24px; }\n\n.sf-chat__form-attachment-icon, .sf-chat__form-send-icon {\n  height: 18px;\n  width: 18px; }\n\n.hide {\n  display: none; }\n\n.sf-chat__loading {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translateY(-50%) translateX(-50%);\n  text-align: center;\n  width: 100%; }\n\n.sf-chat__loading-text {\n  position: absolute;\n  left: 50%;\n  top: calc(50% - 64px);\n  transform: translateX(-50%); }\n\n.sf-chat__loading-img {\n  width: 64px;\n  height: 64px;\n  stroke: #21d276; }\n\n.sf-chat__credits {\n  position: absolute;\n  left: 50%;\n  bottom: -20px;\n  transform: translateX(-50%);\n  text-align: center; }\n\n.sf-chat__credits small {\n  color: #aaa;\n  font-size: 11px; }\n\n.sf-chat__credits small a {\n  color: #16a085;\n  font-weight: 600;\n  text-decoration: none; }\n\nbutton,\ninput {\n  outline: none; }\n\n[disabled] {\n  opacity: 0.5; }\n\n@keyframes pulse {\n  0% {\n    opacity: 0.5; }\n  50% {\n    opacity: 1; }\n  100% {\n    opacity: 0.5; } }\n\n@keyframes fadeInUp {\n  0% {\n    opacity: 0;\n    transform: translateY(10%); }\n  100% {\n    opacity: 1;\n    transform: translateY(0); } }\n',""])},function(e,t,n){var r=n(21);"string"==typeof r&&(r=[[e.i,r,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(19)(r,o);r.locals&&(e.exports=r.locals)},function(e,t,n){"use strict";e.exports=function(e){return function(t){return e.apply(null,t)}}},function(e,t,n){"use strict";var r=n(8);function o(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise(function(e){t=e});var n=this;e(function(e){n.reason||(n.reason=new r(e),t(n.reason))})}o.prototype.throwIfRequested=function(){if(this.reason)throw this.reason},o.source=function(){var e;return{token:new o(function(t){e=t}),cancel:e}},e.exports=o},function(e,t,n){"use strict";e.exports=function(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},function(e,t,n){"use strict";e.exports=function(e){return/^([a-z][a-z\d\+\-\.]*:)?\/\//i.test(e)}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t,n){return r.forEach(n,function(n){e=n(e,t)}),e}},function(e,t,n){"use strict";var r=n(1),o=n(27),i=n(9),s=n(3),a=n(26),u=n(25);function c(e){e.cancelToken&&e.cancelToken.throwIfRequested()}e.exports=function(e){return c(e),e.baseURL&&!a(e.url)&&(e.url=u(e.baseURL,e.url)),e.headers=e.headers||{},e.data=o(e.data,e.headers,e.transformRequest),e.headers=r.merge(e.headers.common||{},e.headers[e.method]||{},e.headers||{}),r.forEach(["delete","get","head","post","put","patch","common"],function(t){delete e.headers[t]}),(e.adapter||s.adapter)(e).then(function(t){return c(e),t.data=o(t.data,t.headers,e.transformResponse),t},function(t){return i(t)||(c(e),t&&t.response&&(t.response.data=o(t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)})}},function(e,t,n){"use strict";var r=n(1);function o(){this.handlers=[]}o.prototype.use=function(e,t){return this.handlers.push({fulfilled:e,rejected:t}),this.handlers.length-1},o.prototype.eject=function(e){this.handlers[e]&&(this.handlers[e]=null)},o.prototype.forEach=function(e){r.forEach(this.handlers,function(t){null!==t&&e(t)})},e.exports=o},function(e,t,n){"use strict";var r=n(1);e.exports=r.isStandardBrowserEnv()?{write:function(e,t,n,o,i,s){var a=[];a.push(e+"="+encodeURIComponent(t)),r.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),r.isString(o)&&a.push("path="+o),r.isString(i)&&a.push("domain="+i),!0===s&&a.push("secure"),document.cookie=a.join("; ")},read:function(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function(e){this.write(e,"",Date.now()-864e5)}}:{write:function(){},read:function(){return null},remove:function(){}}},function(e,t,n){"use strict";var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function o(){this.message="String contains an invalid character"}o.prototype=new Error,o.prototype.code=5,o.prototype.name="InvalidCharacterError",e.exports=function(e){for(var t,n,i=String(e),s="",a=0,u=r;i.charAt(0|a)||(u="=",a%1);s+=u.charAt(63&t>>8-a%1*8)){if((n=i.charCodeAt(a+=.75))>255)throw new o;t=t<<8|n}return s}},function(e,t,n){"use strict";var r=n(1);e.exports=r.isStandardBrowserEnv()?function(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function o(e){var r=e;return t&&(n.setAttribute("href",r),r=n.href),n.setAttribute("href",r),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=o(window.location.href),function(t){var n=r.isString(t)?o(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function(){return!0}},function(e,t,n){"use strict";var r=n(1),o=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function(e){var t,n,i,s={};return e?(r.forEach(e.split("\n"),function(e){if(i=e.indexOf(":"),t=r.trim(e.substr(0,i)).toLowerCase(),n=r.trim(e.substr(i+1)),t){if(s[t]&&o.indexOf(t)>=0)return;s[t]="set-cookie"===t?(s[t]?s[t]:[]).concat([n]):s[t]?s[t]+", "+n:n}}),s):s}},function(e,t,n){"use strict";var r=n(1);function o(e){return encodeURIComponent(e).replace(/%40/gi,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function(e,t,n){if(!t)return e;var i;if(n)i=n(t);else if(r.isURLSearchParams(t))i=t.toString();else{var s=[];r.forEach(t,function(e,t){null!==e&&void 0!==e&&(r.isArray(e)?t+="[]":e=[e],r.forEach(e,function(e){r.isDate(e)?e=e.toISOString():r.isObject(e)&&(e=JSON.stringify(e)),s.push(o(t)+"="+o(e))}))}),i=s.join("&")}return i&&(e+=(-1===e.indexOf("?")?"?":"&")+i),e}},function(e,t,n){"use strict";e.exports=function(e,t,n,r,o){return e.config=t,n&&(e.code=n),e.request=r,e.response=o,e}},function(e,t,n){"use strict";var r=n(10);e.exports=function(e,t,n){var o=n.config.validateStatus;n.status&&o&&!o(n.status)?t(r("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},function(e,t,n){"use strict";var r=n(1);e.exports=function(e,t){r.forEach(e,function(n,r){r!==t&&r.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[r])})}},function(e,t,n){"use strict";var r=n(3),o=n(1),i=n(29),s=n(28);function a(e){this.defaults=e,this.interceptors={request:new i,response:new i}}a.prototype.request=function(e){"string"==typeof e&&(e=o.merge({url:arguments[0]},arguments[1])),(e=o.merge(r,{method:"get"},this.defaults,e)).method=e.method.toLowerCase();var t=[s,void 0],n=Promise.resolve(e);for(this.interceptors.request.forEach(function(e){t.unshift(e.fulfilled,e.rejected)}),this.interceptors.response.forEach(function(e){t.push(e.fulfilled,e.rejected)});t.length;)n=n.then(t.shift(),t.shift());return n},o.forEach(["delete","get","head","options"],function(e){a.prototype[e]=function(t,n){return this.request(o.merge(n||{},{method:e,url:t}))}}),o.forEach(["post","put","patch"],function(e){a.prototype[e]=function(t,n,r){return this.request(o.merge(r||{},{method:e,url:t,data:n}))}}),e.exports=a},function(e,t){function n(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}e.exports=function(e){return null!=e&&(n(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&n(e.slice(0,0))}(e)||!!e._isBuffer)}},function(e,t,n){"use strict";var r=n(1),o=n(12),i=n(38),s=n(3);function a(e){var t=new i(e),n=o(i.prototype.request,t);return r.extend(n,i.prototype,t),r.extend(n,t),n}var u=a(s);u.Axios=i,u.create=function(e){return a(r.merge(s,e))},u.Cancel=n(8),u.CancelToken=n(24),u.isCancel=n(9),u.all=function(e){return Promise.all(e)},u.spread=n(23),e.exports=u,e.exports.default=u},function(e,t,n){"use strict";function r(e,t){if(void 0===e||null===e)throw new TypeError("Cannot convert first argument to object");for(var n=Object(e),r=1;r<arguments.length;r++){var o=arguments[r];if(void 0!==o&&null!==o)for(var i=Object.keys(Object(o)),s=0,a=i.length;s<a;s++){var u=i[s],c=Object.getOwnPropertyDescriptor(o,u);void 0!==c&&c.enumerable&&(n[u]=o[u])}}return n}e.exports={assign:r,polyfill:function(){Object.assign||Object.defineProperty(Object,"assign",{enumerable:!1,configurable:!0,writable:!0,value:r})}}},function(e,t,n){(function(t,n){!function(t,n){e.exports=n()}(0,function(){"use strict";function e(e){return"function"==typeof e}var r=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},o=0,i=void 0,s=void 0,a=function(e,t){p[o]=e,p[o+1]=t,2===(o+=2)&&(s?s(g):m())};var u="undefined"!=typeof window?window:void 0,c=u||{},f=c.MutationObserver||c.WebKitMutationObserver,l="undefined"==typeof self&&void 0!==t&&"[object process]"==={}.toString.call(t),h="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(g,1)}}var p=new Array(1e3);function g(){for(var e=0;e<o;e+=2){(0,p[e])(p[e+1]),p[e]=void 0,p[e+1]=void 0}o=0}var m=void 0;function b(e,t){var n=this,r=new this.constructor(A);void 0===r[y]&&D(r);var o=n._state;if(o){var i=arguments[o-1];a(function(){return k(o,r,i,n._result)})}else T(n,r,e,t);return r}function v(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(A);return j(t,e),t}m=l?function(){return t.nextTick(g)}:f?function(){var e=0,t=new f(g),n=document.createTextNode("");return t.observe(n,{characterData:!0}),function(){n.data=e=++e%2}}():h?function(){var e=new MessageChannel;return e.port1.onmessage=g,function(){return e.port2.postMessage(0)}}():void 0===u?function(){try{var e=Function("return this")().require("vertx");return void 0!==(i=e.runOnLoop||e.runOnContext)?function(){i(g)}:d()}catch(e){return d()}}():d();var y=Math.random().toString(36).substring(2);function A(){}var w=void 0,S=1,I=2,M={error:null};function E(e){try{return e.then}catch(e){return M.error=e,M}}function x(t,n,r){n.constructor===t.constructor&&r===b&&n.constructor.resolve===v?function(e,t){t._state===S?N(e,t._result):t._state===I?_(e,t._result):T(t,void 0,function(t){return j(e,t)},function(t){return _(e,t)})}(t,n):r===M?(_(t,M.error),M.error=null):void 0===r?N(t,n):e(r)?function(e,t,n){a(function(e){var r=!1,o=function(e,t,n,r){try{e.call(t,n,r)}catch(e){return e}}(n,t,function(n){r||(r=!0,t!==n?j(e,n):N(e,n))},function(t){r||(r=!0,_(e,t))},e._label);!r&&o&&(r=!0,_(e,o))},e)}(t,n,r):N(t,n)}function j(e,t){e===t?_(e,new TypeError("You cannot resolve a promise with itself")):!function(e){var t=typeof e;return null!==e&&("object"===t||"function"===t)}(t)?N(e,t):x(e,t,E(t))}function O(e){e._onerror&&e._onerror(e._result),V(e)}function N(e,t){e._state===w&&(e._result=t,e._state=S,0!==e._subscribers.length&&a(V,e))}function _(e,t){e._state===w&&(e._state=I,e._result=t,a(O,e))}function T(e,t,n,r){var o=e._subscribers,i=o.length;e._onerror=null,o[i]=t,o[i+S]=n,o[i+I]=r,0===i&&e._state&&a(V,e)}function V(e){var t=e._subscribers,n=e._state;if(0!==t.length){for(var r=void 0,o=void 0,i=e._result,s=0;s<t.length;s+=3)r=t[s],o=t[s+n],r?k(n,r,o,i):o(i);e._subscribers.length=0}}function k(t,n,r,o){var i=e(r),s=void 0,a=void 0,u=void 0,c=void 0;if(i){if((s=function(e,t){try{return e(t)}catch(e){return M.error=e,M}}(r,o))===M?(c=!0,a=s.error,s.error=null):u=!0,n===s)return void _(n,new TypeError("A promises callback cannot return that same promise."))}else s=o,u=!0;n._state!==w||(i&&u?j(n,s):c?_(n,a):t===S?N(n,s):t===I&&_(n,s))}var R=0;function D(e){e[y]=R++,e._state=void 0,e._result=void 0,e._subscribers=[]}var L=function(){function e(e,t){this._instanceConstructor=e,this.promise=new e(A),this.promise[y]||D(this.promise),r(t)?(this.length=t.length,this._remaining=t.length,this._result=new Array(this.length),0===this.length?N(this.promise,this._result):(this.length=this.length||0,this._enumerate(t),0===this._remaining&&N(this.promise,this._result))):_(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;this._state===w&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var n=this._instanceConstructor,r=n.resolve;if(r===v){var o=E(e);if(o===b&&e._state!==w)this._settledAt(e._state,t,e._result);else if("function"!=typeof o)this._remaining--,this._result[t]=e;else if(n===C){var i=new n(A);x(i,e,o),this._willSettleAt(i,t)}else this._willSettleAt(new n(function(t){return t(e)}),t)}else this._willSettleAt(r(e),t)},e.prototype._settledAt=function(e,t,n){var r=this.promise;r._state===w&&(this._remaining--,e===I?_(r,n):this._result[t]=n),0===this._remaining&&N(r,this._result)},e.prototype._willSettleAt=function(e,t){var n=this;T(e,void 0,function(e){return n._settledAt(S,t,e)},function(e){return n._settledAt(I,t,e)})},e}();var C=function(){function e(t){this[y]=R++,this._result=this._state=void 0,this._subscribers=[],A!==t&&("function"!=typeof t&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(e,t){try{t(function(t){j(e,t)},function(t){_(e,t)})}catch(t){_(e,t)}}(this,t):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(e){return this.then(null,e)},e.prototype.finally=function(e){var t=this.constructor;return this.then(function(n){return t.resolve(e()).then(function(){return n})},function(n){return t.resolve(e()).then(function(){throw n})})},e}();return C.prototype.then=b,C.all=function(e){return new L(this,e).promise},C.race=function(e){var t=this;return r(e)?new t(function(n,r){for(var o=e.length,i=0;i<o;i++)t.resolve(e[i]).then(n,r)}):new t(function(e,t){return t(new TypeError("You must pass an array to race."))})},C.resolve=v,C.reject=function(e){var t=new this(A);return _(t,e),t},C._setScheduler=function(e){s=e},C._setAsap=function(e){a=e},C._asap=a,C.polyfill=function(){var e=void 0;if(void 0!==n)e=n;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=C},C.Promise=C,C})}).call(this,n(13),n(4))},function(e,t,n){"use strict";n.r(t),function(e){var t=n(0),r=n(7),o=n(2),i=n.n(o),s=(n(22),n(6)),a=n.n(s),u=n(17),c=n.n(u),f=n(16),l=n.n(f),h=n(15),d=n.n(h),p=n(5),g=n.n(p),m=n(14),b=n.n(m);"undefined"==typeof Promise&&n(42).polyfill(),void 0===Object.assign&&n(41).polyfill(),document.body.insertAdjacentHTML("beforeend",'<div class="sf-chat-instance" id="sf-chat-instance"></div>');var v=document.querySelector("#sf-chat-instance"),y=new Audio(b.a),A={message_limit:5},w={user:{avatarURL:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"},room:{currentUsers:[],loading:!0},messages:[],attachment:{},messageText:{value:""},file:{},uploadInProgress:{status:!1},widgetStatus:{active:!0}},S={setUser:function(e){return{user:e}},setRoom:function(e){return function(t){t.messages,t.user;return e.currentUsers=[],e.loading=!1,{room:e}}},setMessage:function(e){return function(t){var n=t.messageText;return n.value=e,e?n.value:" "}},setUploadStatus:function(e){return function(t){var n=t.uploadInProgress;return n.status=e,n.status}},getMicroData:function(e,t){e.attachment&&i.a.get("https://api.microlink.io?url="+e.attachment.link).then(function(t){e.attachment_metadata=t.data.data,E(e)}).catch(function(e){console.log(e)})},addMessage:function(e){return function(t){var n=t.messages,r=t.user;if(n.push(e),"DELETED"===e.text){var o=n.indexOf(e);return n.splice(o,1),n.forEach(function(t,r){t.id===e.id&&n.splice(r,1)}),n}var s=/(?:(?:https?|ftp|file):\/\/|www\.|ftp\.)(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[-A-Z0-9+&@#\/%=~_|$?!:,.])*(?:\([-A-Z0-9+&@#\/%=~_|$?!:,.]*\)|[A-Z0-9+&@#\/%=~_|$])/gim;return e.text.match(s)&&i.a.get("https://api.microlink.io?url="+e.text.match(s)[0]).then(function(t){e.unfurl=t.data.data,E(e)}).catch(function(e){console.log(e)}),V(e),setTimeout(function(){k(e)},500),e.senderId!==r.id&&n.length>A.message_limit&&y.play(),n}},updateMessage:function(e){return function(t){var n=t.messages,r=n.indexOf(e);return n.splice(r,1,e),n}},submitMessage:function(e){return function(t){var n=t.user,r=t.room,o=e.target.value?e.target.value:e.target.elements[0].value;o&&(n.sendMessage({text:o,roomId:r.id}),i.a.post("https://shelfi.shop/api/post-to-slack",{text:o,attachment:{},roomId:r.id,roomName:r.name,userName:n.name}).then(function(e){}).catch(function(e){console.log(e)}))}},collectUsers:function(e){return function(t){var n=t.room;return n.currentUsers.length>0?n.currentUsers.map(function(t){t!==e&&n.currentUsers.push(e)}):n.currentUsers.push(e),n.currentUsers}},checkBlock:function(e){return function(t){t.user;var n=t.messages,r=n.indexOf(e),o=n[r-1];return 0===r?(o=n[r+1],e.senderId!==o.senderId&&(e.block=!0)):e.senderId!==o.senderId&&(e.block=!0),n}},uploadClipboard:function(e){return function(t){var n=t.file;if(console.log(e.clipboardData),console.log(e.clipboardData.items),event.clipboardData.files.length)return n=event.clipboardData.files,D(n),{file:n}}},upload:function(e){return function(t){var n=t.user,r=t.room;T(!0);for(var o=[],s=new FormData,a=0;a<e.length;a++)o.push(e[a]);o.forEach(function(e){s.append("item",e),s.append("data","string"),s.append("userId",n.id),s.append("roomName",r.name)}),i.a.post("https://shelfi.shop/api/upload",s,{headers:{"Content-Type":"multipart/form-data"}}).then(function(){o=null,T(!1),console.log("upload successful")}).catch(function(e){console.log(e),console.log("upload failed!!!")})}},toggleWidget:function(e){return function(e){var t=e.widgetStatus;return t.active=!t.active,t}}},I=Object(t.a)(w,S,q,v),M=I.addMessage,E=I.updateMessage,x=I.setUser,j=I.setRoom,O=I.setMessage,N=I.submitMessage,_=I.collectUsers,T=I.setUploadStatus,V=I.getMicroData,k=I.checkBlock,R=I.uploadClipboard,D=I.upload,L=I.toggleWidget,C=function(e){e.user;var n=e.room,r=(e.message,e.status);return Object(t.b)("sf-chat-header",null,Object(t.b)("p",null,n.name,n.currentUsers.length>0&&Object(t.b)("small",null," (",n.currentUsers.length," online)")),r.active&&Object(t.b)("img",{class:"sf-chat-header__close",src:g.a,alt:"Close",onclick:function(e){e.preventDefault(),L(e)}}))},P=function(e){var n=e.user,r=e.messages,o=e.room;return Object(t.b)("div",{class:"sf-chat__body",onupdate:function(e){e.scrollTop=e.scrollHeight},oncreate:function(e){e.scrollTop=e.scrollHeight,o.loading=!1},ondragover:function(e){e.preventDefault(),e.stopPropagation()},ondrop:function(e){e.preventDefault(),console.log(e),D(e.dataTransfer.files)}},o.loading&&Object(t.b)("div",{class:"sf-chat__loading"},Object(t.b)("small",{class:"sf-chat__loading-text"},"loading..."),Object(t.b)("img",{class:"sf-chat__loading-img",src:a.a})),r.map(function(e){return Object(t.b)("sf-chat-message",{key:e.id,class:e.sender.id===n.id&&"active-user",onupdate:function(t){return e.block&&t.setAttribute("block","")},oncreate:function(t){return e.block&&t.setAttribute("block","")}},e.sender.avatarURL&&Object(t.b)("div",{class:"sf-chat__user-avatar"},Object(t.b)("img",{src:e.sender.avatarURL||n.avatarURL})),Object(t.b)("div",{class:"sf-chat__message-wrap"},e.block&&Object(t.b)("div",{class:"sf-chat__username"},Object(t.b)("small",null,e.sender.name)),e.attachment&&e.attachment_metadata&&Object(t.b)("div",{class:"sf-chat__attachment"},Object(t.b)("a",{href:e.attachment_metadata.url,target:"_blank"},Object(t.b)("img",{class:"sf-chat__attachment-preview",src:e.attachment_metadata.image.url}))),Object(t.b)("div",{class:"sf-chat__message-text"},Object(t.b)("p",null,e.text),e.unfurl&&Object(t.b)("div",{class:"sf-chat__message-unfurl"},Object(t.b)("span",{class:"sf-chat__message-unfurl-title"},e.unfurl.title),Object(t.b)("a",{href:e.unfurl.url,target:"_blank"},Object(t.b)("img",{class:"sf-chat__message-unfurl-img",src:e.unfurl.image.url})),Object(t.b)("a",{class:"sf-chat__message-unfurl-url",target:"_blank",href:e.unfurl.url},e.unfurl.url)))))}))},U=function(e){e.user,e.room;var n=e.message;return Object(t.b)("div",{class:"sf-chat__form-input"},Object(t.b)("form",{onpaste:function(e){e.preventDefault(),R(e)},oninput:function(e){e.preventDefault(),O(e.target.value)},onsubmit:function(e){e.preventDefault(),N(e),e.target.elements[0].value=""},onkeydown:function(e){"Enter"===e.key&&!1===e.shiftKey&&(e.preventDefault(),N(e),e.target.value="")}},Object(t.b)("textarea",{placeholder:"Reply here.."}),n.value.length>0&&Object(t.b)("button",null,Object(t.b)("img",{class:"sf-chat__form-send-icon",src:c.a}))))},z=function(e){var n=e.file,r=(e.user,e.room,e.message),o=e.uploadInProgress;return Object(t.b)("div",{class:"sf-chat__form-uploader"},o.status&&Object(t.b)("img",{class:"sf-chat__form-loader-icon",src:a.a}),!o.status&&Object(t.b)("form",{onchange:function(e){e.preventDefault(),n=document.getElementById("uploader").files,D(n)}},!r.value.length>0&&Object(t.b)("label",{for:"uploader"},!o.status&&Object(t.b)("img",{class:"sf-chat__form-attachment-icon",src:l.a})),Object(t.b)("input",{type:"text",id:"roomname",name:"roomName",value:"{room.name}"}),Object(t.b)("input",{type:"text",id:"username",name:"userName",value:"{user.id}"}),Object(t.b)("input",{id:"uploader",name:"uploader",type:"file",multiple:"multiple",class:"hide"})))},B=function(e){var n=e.status;return Object(t.b)("div",{class:"sf-chat-launcher bottom left"+(n.active?" active":" hidden"),onclick:function(e){e.preventDefault(),L(e)}},n.active&&Object(t.b)("img",{class:"sf-chat-launcher__close",src:g.a,alt:"Close"}),!n.active&&Object(t.b)("img",{class:"sf-chat-launcher__chat",src:d.a,alt:"Launch"}))};function q(e,n){return Object(t.b)("div",{class:"sf-chat__wrapper"},e.widgetStatus.active&&Object(t.b)("sf-chat",{class:"bottom left"},Object(t.b)("div",{class:"sf-chat__header"},Object(t.b)(C,{user:e.user,room:e.room,message:e.messageText,status:e.widgetStatus})),Object(t.b)("div",{class:"sf-chat__container"},Object(t.b)(P,{user:e.user,messages:e.messages,room:e.room,attachment:e.attachment})),Object(t.b)("div",{class:"sf-chat__footer"},Object(t.b)(U,{user:e.user,room:e.room,message:e.messageText}),Object(t.b)(z,{file:e.file,user:e.user,room:e.room,message:e.messageText,uploadInProgress:e.uploadInProgress})),Object(t.b)("div",{class:"sf-chat__credits"},Object(t.b)("small",null,"Powered by ",Object(t.b)("a",{target:"_blank",href:"http://shelfi.net"},"ShelfiChat")))),Object(t.b)(B,{status:e.widgetStatus}))}e._sfchat=new function(){this.chatManager={},this.create=function(){document.body.insertAdjacentHTML("beforeend",'<div class="sf-chat-instance" id="sf-chat-instance"></div>'),v=document.querySelector("#sf-chat-instance"),Object(t.a)(w,S,q,v)},this.init=function(e,t,n){n||(n=A),document.onreadystatechange=function(){if("complete"===document.readyState){var o=new r.TokenProvider({url:"https://shelfi.shop/api/auth"});_sfchat.chatManager=new r.ChatManager({instanceLocator:e,userId:t.user_id,tokenProvider:o}),_sfchat.auth(t,n)}}},this.destroy=function(){document.getElementById("sf-chat-instance").remove()},this.toggle=function(){L()},this.getRoom=function(e){return i.a.post("https://shelfi.shop/api/init",{user_id:e.user_id,user_name:e.user_name,group:e.group}).then(function(e){return e.data})},this.auth=function(e,t){_sfchat.getRoom(e).then(function(e){_sfchat.chatManager.connect().then(function(n){x(n),n.subscribeToRoom({roomId:e.id,hooks:{onNewMessage:M,onUserCameOnline:_},messageLimit:t.message_limit}).then(function(e){setTimeout(function(){j(e)},0)})})})}}}.call(this,n(4))}]);